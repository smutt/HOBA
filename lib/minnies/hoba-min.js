/* asn1hex-1.1.js (c) 2012 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
function _asnhex_getByteLengthOfL_AtObj(b,c){if(b.substring(c+2,c+3)!="8"){return 1}var a=parseInt(b.substring(c+3,c+4));if(a==0){return -1}if(0<a&&a<10){return a+1}return -2}function _asnhex_getHexOfL_AtObj(b,c){var a=_asnhex_getByteLengthOfL_AtObj(b,c);if(a<1){return""}return b.substring(c+2,c+2+a*2)}function _asnhex_getIntOfL_AtObj(c,d){var b=_asnhex_getHexOfL_AtObj(c,d);if(b==""){return -1}var a;if(parseInt(b.substring(0,1))<8){a=parseBigInt(b,16)}else{a=parseBigInt(b.substring(2),16)}return a.intValue()}function _asnhex_getStartPosOfV_AtObj(b,c){var a=_asnhex_getByteLengthOfL_AtObj(b,c);if(a<0){return a}return c+(a+1)*2}function _asnhex_getHexOfV_AtObj(c,d){var b=_asnhex_getStartPosOfV_AtObj(c,d);var a=_asnhex_getIntOfL_AtObj(c,d);return c.substring(b,b+a*2)}function _asnhex_getHexOfTLV_AtObj(c,e){var b=c.substr(e,2);var d=_asnhex_getHexOfL_AtObj(c,e);var a=_asnhex_getHexOfV_AtObj(c,e);return b+d+a}function _asnhex_getPosOfNextSibling_AtObj(c,d){var b=_asnhex_getStartPosOfV_AtObj(c,d);var a=_asnhex_getIntOfL_AtObj(c,d);return b+a*2}function _asnhex_getPosArrayOfChildren_AtObj(f,l){var c=new Array();var j=_asnhex_getStartPosOfV_AtObj(f,l);c.push(j);var b=_asnhex_getIntOfL_AtObj(f,l);var g=j;var d=0;while(1){var e=_asnhex_getPosOfNextSibling_AtObj(f,g);if(e==null||(e-j>=(b*2))){break}if(d>=200){break}c.push(e);g=e;d++}return c}function _asnhex_getNthChildIndex_AtObj(d,b,e){var c=_asnhex_getPosArrayOfChildren_AtObj(d,b);return c[e]}function _asnhex_getDecendantIndexByNthList(e,d,c){if(c.length==0){return d}var f=c.shift();var b=_asnhex_getPosArrayOfChildren_AtObj(e,d);return _asnhex_getDecendantIndexByNthList(e,b[f],c)}function _asnhex_getDecendantHexTLVByNthList(d,c,b){var a=_asnhex_getDecendantIndexByNthList(d,c,b);return _asnhex_getHexOfTLV_AtObj(d,a)}function _asnhex_getDecendantHexVByNthList(d,c,b){var a=_asnhex_getDecendantIndexByNthList(d,c,b);return _asnhex_getHexOfV_AtObj(d,a)}function ASN1HEX(){return ASN1HEX}ASN1HEX.getByteLengthOfL_AtObj=_asnhex_getByteLengthOfL_AtObj;ASN1HEX.getHexOfL_AtObj=_asnhex_getHexOfL_AtObj;ASN1HEX.getIntOfL_AtObj=_asnhex_getIntOfL_AtObj;ASN1HEX.getStartPosOfV_AtObj=_asnhex_getStartPosOfV_AtObj;ASN1HEX.getHexOfV_AtObj=_asnhex_getHexOfV_AtObj;ASN1HEX.getHexOfTLV_AtObj=_asnhex_getHexOfTLV_AtObj;ASN1HEX.getPosOfNextSibling_AtObj=_asnhex_getPosOfNextSibling_AtObj;ASN1HEX.getPosArrayOfChildren_AtObj=_asnhex_getPosArrayOfChildren_AtObj;ASN1HEX.getNthChildIndex_AtObj=_asnhex_getNthChildIndex_AtObj;ASN1HEX.getDecendantIndexByNthList=_asnhex_getDecendantIndexByNthList;ASN1HEX.getDecendantHexVByNthList=_asnhex_getDecendantHexVByNthList;ASN1HEX.getDecendantHexTLVByNthList=_asnhex_getDecendantHexTLVByNthList;var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64pad="=";function hex2b64(d){var b;var e;var a="";for(b=0;b+3<=d.length;b+=3){e=parseInt(d.substring(b,b+3),16);a+=b64map.charAt(e>>6)+b64map.charAt(e&63)}if(b+1==d.length){e=parseInt(d.substring(b,b+1),16);a+=b64map.charAt(e<<2)}else{if(b+2==d.length){e=parseInt(d.substring(b,b+2),16);a+=b64map.charAt(e>>2)+b64map.charAt((e&3)<<4)}}if(b64pad){while((a.length&3)>0){a+=b64pad}}return a}function b64tohex(e){var c="";var d;var a=0;var b;for(d=0;d<e.length;++d){if(e.charAt(d)==b64pad){break}v=b64map.indexOf(e.charAt(d));if(v<0){continue}if(a==0){c+=int2char(v>>2);b=v&3;a=1}else{if(a==1){c+=int2char((b<<2)|(v>>4));b=v&15;a=2}else{if(a==2){c+=int2char(b);c+=int2char(v>>2);b=v&3;a=3}else{c+=int2char((b<<2)|(v>>4));c+=int2char(v&15);a=0}}}}if(a==1){c+=int2char(b<<2)}return c}function b64toBA(e){var d=b64tohex(e);var c;var b=new Array();for(c=0;2*c<d.length;++c){b[c]=parseInt(d.substring(2*c,2*c+2),16)}return b}
/* crypto-1.0.3.js (c) 2013 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
if(typeof KJUR=="undefined"||!KJUR){KJUR={}}if(typeof KJUR.crypto=="undefined"||!KJUR.crypto){KJUR.crypto={}}KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"};this.getDigestInfoHex=function(a,b){if(typeof this.DIGESTINFOHEAD[b]=="undefined"){throw"alg not supported in Util.DIGESTINFOHEAD: "+b}return this.DIGESTINFOHEAD[b]+a};this.getPaddedDigestInfoHex=function(h,a,j){var c=this.getDigestInfoHex(h,a);var d=j/4;if(c.length+22>d){throw"key is too short for SigAlg: keylen="+j+","+a}var b="0001";var k="00"+c;var g="";var l=d-b.length-k.length;for(var f=0;f<l;f+=2){g+="ff"}var e=b+g+k;return e};this.sha1=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return b.digestString(a)};this.sha256=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return b.digestString(a)};this.sha512=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return b.digestString(a)};this.md5=function(a){var b=new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return b.digestString(a)};this.ripemd160=function(a){var b=new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return b.digestString(a)}};KJUR.crypto.MessageDigest=function(params){var md=null;var algName=null;var provName=null;var _CryptoJSMdName={md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160"};this.setAlgAndProvider=function(alg,prov){if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(alg)!=-1&&prov=="cryptojs"){try{this.md=eval(_CryptoJSMdName[alg]).create()}catch(ex){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+ex}this.updateString=function(str){this.md.update(str)};this.updateHex=function(hex){var wHex=CryptoJS.enc.Hex.parse(hex);this.md.update(wHex)};this.digest=function(){var hash=this.md.finalize();return hash.toString(CryptoJS.enc.Hex)};this.digestString=function(str){this.updateString(str);return this.digest()};this.digestHex=function(hex){this.updateHex(hex);return this.digest()}}};this.updateString=function(str){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.updateHex=function(hex){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestString=function(str){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestHex=function(hex){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};if(typeof params!="undefined"){if(typeof params.alg!="undefined"){this.algName=params.alg;this.provName=params.prov;this.setAlgAndProvider(params.alg,params.prov)}}};KJUR.crypto.Signature=function(g){var k=null;var j=null;var m=null;var q=null;var c=null;var o=null;var b=null;var p=null;var e=null;var a=null;var f=null;var d=null;var n=null;var h=null;this._setAlgNames=function(){if(this.algName.match(/^(.+)with(.+)$/)){this.mdAlgName=RegExp.$1.toLowerCase();this.pubkeyAlgName=RegExp.$2.toLowerCase()}};this._zeroPaddingOfSignature=function(y,x){var w="";var r=x/4-y.length;for(var u=0;u<r;u++){w=w+"0"}return w+y};this.setAlgAndProvider=function(u,s){this._setAlgNames();if(s!="cryptojs/jsrsa"){throw"provider not supported: "+s}if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName,prov:"cryptojs"})}catch(r){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+r}this.initSign=function(w){this.prvKey=w;this.state="SIGN"};this.initVerifyByPublicKey=function(w){this.pubKey=w;this.state="VERIFY"};this.initVerifyByCertificatePEM=function(w){var x=new X509();x.readCertPEM(w);this.pubKey=x.subjectPublicKeyRSA;this.state="VERIFY"};this.updateString=function(w){this.md.updateString(w)};this.updateHex=function(w){this.md.updateHex(w)};this.sign=function(){var w=KJUR.crypto.Util;var x=this.prvKey.n.bitLength();this.sHashHex=this.md.digest();this.hDigestInfo=w.getDigestInfoHex(this.sHashHex,this.mdAlgName);this.hPaddedDigestInfo=w.getPaddedDigestInfoHex(this.sHashHex,this.mdAlgName,x);var A=parseBigInt(this.hPaddedDigestInfo,16);this.hoge=A.toString(16);var y=this.prvKey.doPrivate(A);this.hSign=this._zeroPaddingOfSignature(y.toString(16),x);return this.hSign};this.signString=function(w){this.updateString(w);this.sign()};this.signHex=function(w){this.updateHex(w);this.sign()};this.verify=function(w){var x=KJUR.crypto.Util;var A=this.pubKey.n.bitLength();this.sHashHex=this.md.digest();var E=parseBigInt(w,16);var D=this.pubKey.doPublic(E);this.hPaddedDigestInfo=D.toString(16);var C=this.hPaddedDigestInfo;C=C.replace(/^1ff+00/,"");var y=KJUR.crypto.Util.DIGESTINFOHEAD[this.mdAlgName];if(C.indexOf(y)!=0){return false}var B=C.substr(y.length);return(B==this.sHashHex)}}};this.initVerifyByPublicKey=function(r){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName};this.initVerifyByCertificatePEM=function(r){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName};this.initSign=function(r){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName};this.updateString=function(r){throw"updateString(str) not supported for this alg:prov="+this.algProvName};this.updateHex=function(r){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName};this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName};this.signString=function(r){throw"digestString(str) not supported for this alg:prov="+this.algProvName};this.signHex=function(r){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName};this.verify=function(r){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName};if(typeof g!="undefined"){if(typeof g.alg!="undefined"){this.algName=g.alg;this.provName=g.prov;this.algProvName=g.alg+":"+g.prov;this.setAlgAndProvider(g.alg,g.prov);this._setAlgNames()}if(typeof g.prvkeypem!="undefined"){if(typeof g.prvkeypas!="undefined"){throw"both prvkeypem and prvkeypas parameters not supported"}else{try{var k=new RSAKey();k.readPrivateKeyFromPEMString(g.prvkeypem);this.initSign(k)}catch(l){throw"fatal error to load pem private key: "+l}}}}};function bnClone(){var a=nbi();this.copyTo(a);return a}function bnIntValue(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function bnByteValue(){return(this.t==0)?this.s:(this[0]<<24)>>24}function bnShortValue(){return(this.t==0)?this.s:(this[0]<<16)>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function bnSigNum(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function bnpToRadix(c){if(c==null){c=10}if(this.signum()==0||c<2||c>36){return"0"}var f=this.chunkSize(c);var e=Math.pow(c,f);var j=nbv(e),k=nbi(),h=nbi(),g="";this.divRemTo(j,k,h);while(k.signum()>0){g=(e+h.intValue()).toString(c).substr(1)+g;k.divRemTo(j,k,h)}return h.intValue().toString(c)+g}function bnpFromRadix(m,h){this.fromInt(0);if(h==null){h=10}var f=this.chunkSize(h);var g=Math.pow(h,f),e=false,a=0,l=0;for(var c=0;c<m.length;++c){var k=intAt(m,c);if(k<0){if(m.charAt(c)=="-"&&this.signum()==0){e=true}continue}l=h*l+k;if(++a>=f){this.dMultiply(g);this.dAddOffset(l,0);a=0;l=0}}if(a>0){this.dMultiply(Math.pow(h,a));this.dAddOffset(l,0)}if(e){BigInteger.ZERO.subTo(this,this)}}function bnpFromNumber(f,e,h){if("number"==typeof e){if(f<2){this.fromInt(1)}else{this.fromNumber(f,h);if(!this.testBit(f-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(f-1),op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(e)){this.dAddOffset(2,0);if(this.bitLength()>f){this.subTo(BigInteger.ONE.shiftLeft(f-1),this)}}}}else{var d=new Array(),g=f&7;d.length=(f>>3)+1;e.nextBytes(d);if(g>0){d[0]&=((1<<g)-1)}else{d[0]=0}this.fromString(d,256)}}function bnToByteArray(){var b=this.t,c=new Array();c[0]=this.s;var e=this.DB-(b*this.DB)%8,f,a=0;if(b-->0){if(e<this.DB&&(f=this[b]>>e)!=(this.s&this.DM)>>e){c[a++]=f|(this.s<<(this.DB-e))}while(b>=0){if(e<8){f=(this[b]&((1<<e)-1))<<(8-e);f|=this[--b]>>(e+=this.DB-8)}else{f=(this[b]>>(e-=8))&255;if(e<=0){e+=this.DB;--b}}if((f&128)!=0){f|=-256}if(a==0&&(this.s&128)!=(f&128)){++a}if(a>0||f!=this.s){c[a++]=f}}}return c}function bnEquals(b){return(this.compareTo(b)==0)}function bnMin(b){return(this.compareTo(b)<0)?this:b}function bnMax(b){return(this.compareTo(b)>0)?this:b}function bnpBitwiseTo(c,h,e){var d,g,b=Math.min(c.t,this.t);for(d=0;d<b;++d){e[d]=h(this[d],c[d])}if(c.t<this.t){g=c.s&this.DM;for(d=b;d<this.t;++d){e[d]=h(this[d],g)}e.t=this.t}else{g=this.s&this.DM;for(d=b;d<c.t;++d){e[d]=h(g,c[d])}e.t=c.t}e.s=h(this.s,c.s);e.clamp()}function op_and(a,b){return a&b}function bnAnd(b){var c=nbi();this.bitwiseTo(b,op_and,c);return c}function op_or(a,b){return a|b}function bnOr(b){var c=nbi();this.bitwiseTo(b,op_or,c);return c}function op_xor(a,b){return a^b}function bnXor(b){var c=nbi();this.bitwiseTo(b,op_xor,c);return c}function op_andnot(a,b){return a&~b}function bnAndNot(b){var c=nbi();this.bitwiseTo(b,op_andnot,c);return c}function bnNot(){var b=nbi();for(var a=0;a<this.t;++a){b[a]=this.DM&~this[a]}b.t=this.t;b.s=~this.s;return b}function bnShiftLeft(b){var a=nbi();if(b<0){this.rShiftTo(-b,a)}else{this.lShiftTo(b,a)}return a}function bnShiftRight(b){var a=nbi();if(b<0){this.lShiftTo(-b,a)}else{this.rShiftTo(b,a)}return a}function lbit(a){if(a==0){return -1}var b=0;if((a&65535)==0){a>>=16;b+=16}if((a&255)==0){a>>=8;b+=8}if((a&15)==0){a>>=4;b+=4}if((a&3)==0){a>>=2;b+=2}if((a&1)==0){++b}return b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a){if(this[a]!=0){return a*this.DB+lbit(this[a])}}if(this.s<0){return this.t*this.DB}return -1}function cbit(a){var b=0;while(a!=0){a&=a-1;++b}return b}function bnBitCount(){var c=0,a=this.s&this.DM;for(var b=0;b<this.t;++b){c+=cbit(this[b]^a)}return c}function bnTestBit(b){var a=Math.floor(b/this.DB);if(a>=this.t){return(this.s!=0)}return((this[a]&(1<<(b%this.DB)))!=0)}function bnpChangeBit(c,b){var a=BigInteger.ONE.shiftLeft(c);this.bitwiseTo(a,b,a);return a}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}function bnpAddTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]+d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g+=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g+=d[e];f[e++]=g&this.DM;g>>=this.DB}g+=d.s}f.s=(g<0)?-1:0;if(g>0){f[e++]=g}else{if(g<-1){f[e++]=this.DV+g}}f.t=e;f.clamp()}function bnAdd(b){var c=nbi();this.addTo(b,c);return c}function bnSubtract(b){var c=nbi();this.subTo(b,c);return c}function bnMultiply(b){var c=nbi();this.multiplyTo(b,c);return c}function bnSquare(){var a=nbi();this.squareTo(a);return a}function bnDivide(b){var c=nbi();this.divRemTo(b,c,null);return c}function bnRemainder(b){var c=nbi();this.divRemTo(b,null,c);return c}function bnDivideAndRemainder(b){var d=nbi(),c=nbi();this.divRemTo(b,d,c);return new Array(d,c)}function bnpDMultiply(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(b,a){if(b==0){return}while(this.t<=a){this[this.t++]=0}this[a]+=b;while(this[a]>=this.DV){this[a]-=this.DV;if(++a>=this.t){this[this.t++]=0}++this[a]}}function NullExp(){}function nNop(a){return a}function nMulTo(a,c,b){a.multiplyTo(c,b)}function nSqrTo(a,b){a.squareTo(b)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(a){return this.exp(a,new NullExp())}function bnpMultiplyLowerTo(b,f,e){var d=Math.min(this.t+b.t,f);e.s=0;e.t=d;while(d>0){e[--d]=0}var c;for(c=e.t-this.t;d<c;++d){e[d+this.t]=this.am(0,b[d],e,d,0,this.t)}for(c=Math.min(b.t,f);d<c;++d){this.am(0,b[d],e,d,0,f-d)}e.clamp()}function bnpMultiplyUpperTo(b,e,d){--e;var c=d.t=this.t+b.t-e;d.s=0;while(--c>=0){d[c]=0}for(c=Math.max(e-this.t,0);c<b.t;++c){d[this.t+c-e]=this.am(e-c,b[c],d,0,0,this.t+c-e)}d.clamp();d.drShiftTo(1,d)}function Barrett(a){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}function barrettConvert(a){if(a.s<0||a.t>2*this.m.t){return a.mod(this.m)}else{if(a.compareTo(this.m)<0){return a}else{var b=nbi();a.copyTo(b);this.reduce(b);return b}}}function barrettRevert(a){return a}function barrettReduce(a){a.drShiftTo(this.m.t-1,this.r2);if(a.t>this.m.t+1){a.t=this.m.t+1;a.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(a.compareTo(this.r2)<0){a.dAddOffset(1,this.m.t+1)}a.subTo(this.r2,a);while(a.compareTo(this.m)>=0){a.subTo(this.m,a)}}function barrettSqrTo(a,b){a.squareTo(b);this.reduce(b)}function barrettMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(q,f){var o=q.bitLength(),h,b=nbv(1),x;if(o<=0){return b}else{if(o<18){h=1}else{if(o<48){h=3}else{if(o<144){h=4}else{if(o<768){h=5}else{h=6}}}}}if(o<8){x=new Classic(f)}else{if(f.isEven()){x=new Barrett(f)}else{x=new Montgomery(f)}}var p=new Array(),d=3,s=h-1,a=(1<<h)-1;p[1]=x.convert(this);if(h>1){var B=nbi();x.sqrTo(p[1],B);while(d<=a){p[d]=nbi();x.mulTo(B,p[d-2],p[d]);d+=2}}var l=q.t-1,y,u=true,c=nbi(),A;o=nbits(q[l])-1;while(l>=0){if(o>=s){y=(q[l]>>(o-s))&a}else{y=(q[l]&((1<<(o+1))-1))<<(s-o);if(l>0){y|=q[l-1]>>(this.DB+o-s)}}d=h;while((y&1)==0){y>>=1;--d}if((o-=d)<0){o+=this.DB;--l}if(u){p[y].copyTo(b);u=false}else{while(d>1){x.sqrTo(b,c);x.sqrTo(c,b);d-=2}if(d>0){x.sqrTo(b,c)}else{A=b;b=c;c=A}x.mulTo(c,p[y],b)}while(l>=0&&(q[l]&(1<<o))==0){x.sqrTo(b,c);A=b;b=c;c=A;if(--o<0){o=this.DB-1;--l}}}return x.revert(b)}function bnGCD(c){var b=(this.s<0)?this.negate():this.clone();var h=(c.s<0)?c.negate():c.clone();if(b.compareTo(h)<0){var e=b;b=h;h=e}var d=b.getLowestSetBit(),f=h.getLowestSetBit();if(f<0){return b}if(d<f){f=d}if(f>0){b.rShiftTo(f,b);h.rShiftTo(f,h)}while(b.signum()>0){if((d=b.getLowestSetBit())>0){b.rShiftTo(d,b)}if((d=h.getLowestSetBit())>0){h.rShiftTo(d,h)}if(b.compareTo(h)>=0){b.subTo(h,b);b.rShiftTo(1,b)}else{h.subTo(b,h);h.rShiftTo(1,h)}}if(f>0){h.lShiftTo(f,h)}return h}function bnpModInt(e){if(e<=0){return 0}var c=this.DV%e,b=(this.s<0)?e-1:0;if(this.t>0){if(c==0){b=this[0]%e}else{for(var a=this.t-1;a>=0;--a){b=(c*b+this[a])%e}}}return b}function bnModInverse(f){var k=f.isEven();if((this.isEven()&&k)||f.signum()==0){return BigInteger.ZERO}var j=f.clone(),h=this.clone();var g=nbv(1),e=nbv(0),n=nbv(0),l=nbv(1);while(j.signum()!=0){while(j.isEven()){j.rShiftTo(1,j);if(k){if(!g.isEven()||!e.isEven()){g.addTo(this,g);e.subTo(f,e)}g.rShiftTo(1,g)}else{if(!e.isEven()){e.subTo(f,e)}}e.rShiftTo(1,e)}while(h.isEven()){h.rShiftTo(1,h);if(k){if(!n.isEven()||!l.isEven()){n.addTo(this,n);l.subTo(f,l)}n.rShiftTo(1,n)}else{if(!l.isEven()){l.subTo(f,l)}}l.rShiftTo(1,l)}if(j.compareTo(h)>=0){j.subTo(h,j);if(k){g.subTo(n,g)}e.subTo(l,e)}else{h.subTo(j,h);if(k){n.subTo(g,n)}l.subTo(e,l)}}if(h.compareTo(BigInteger.ONE)!=0){return BigInteger.ZERO}if(l.compareTo(f)>=0){return l.subtract(f)}if(l.signum()<0){l.addTo(f,l)}else{return l}if(l.signum()<0){return l.add(f)}else{return l}}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(e){var d,b=this.abs();if(b.t==1&&b[0]<=lowprimes[lowprimes.length-1]){for(d=0;d<lowprimes.length;++d){if(b[0]==lowprimes[d]){return true}}return false}if(b.isEven()){return false}d=1;while(d<lowprimes.length){var a=lowprimes[d],c=d+1;while(c<lowprimes.length&&a<lplim){a*=lowprimes[c++]}a=b.modInt(a);while(d<c){if(a%lowprimes[d++]==0){return false}}}return b.millerRabin(e)}function bnpMillerRabin(f){var g=this.subtract(BigInteger.ONE);var c=g.getLowestSetBit();if(c<=0){return false}var h=g.shiftRight(c);f=(f+1)>>1;if(f>lowprimes.length){f=lowprimes.length}var b=nbi();for(var e=0;e<f;++e){b.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var l=b.modPow(h,this);if(l.compareTo(BigInteger.ONE)!=0&&l.compareTo(g)!=0){var d=1;while(d++<c&&l.compareTo(g)!=0){l=l.modPowInt(2,this);if(l.compareTo(BigInteger.ONE)==0){return false}}if(l.compareTo(g)!=0){return false}}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;var dbits;var canary=244837814094590;var j_lm=((canary&16777215)==15715070);function BigInteger(e,d,f){if(e!=null){if("number"==typeof e){this.fromNumber(e,d,f)}else{if(d==null&&"string"!=typeof e){this.fromString(e,256)}else{this.fromString(e,d)}}}}function nbi(){return new BigInteger(null)}function am1(f,a,b,e,h,g){while(--g>=0){var d=a*this[f++]+b[e]+h;h=Math.floor(d/67108864);b[e++]=d&67108863}return h}function am2(f,q,r,e,o,a){var k=q&32767,p=q>>15;while(--a>=0){var d=this[f]&32767;var g=this[f++]>>15;var b=p*d+g*k;d=k*d+((b&32767)<<15)+r[e]+(o&1073741823);o=(d>>>30)+(b>>>15)+p*g+(o>>>30);r[e++]=d&1073741823}return o}function am3(f,q,r,e,o,a){var k=q&16383,p=q>>14;while(--a>=0){var d=this[f]&16383;var g=this[f++]>>14;var b=p*d+g*k;d=k*d+((b&16383)<<14)+r[e]+o;o=(d>>28)+(b>>14)+p*g;r[e++]=d&268435455}return o}if(j_lm&&(navigator.appName=="Microsoft Internet Explorer")){BigInteger.prototype.am=am2;dbits=30}else{if(j_lm&&(navigator.appName!="Netscape")){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=((1<<dbits)-1);BigInteger.prototype.DV=(1<<dbits);var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array();var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}function int2char(a){return BI_RM.charAt(a)}function intAt(b,a){var d=BI_RC[b.charCodeAt(a)];return(d==null)?-1:d}function bnpCopyTo(b){for(var a=this.t-1;a>=0;--a){b[a]=this[a]}b.t=this.t;b.s=this.s}function bnpFromInt(a){this.t=1;this.s=(a<0)?-1:0;if(a>0){this[0]=a}else{if(a<-1){this[0]=a+DV}else{this.t=0}}}function nbv(a){var b=nbi();b.fromInt(a);return b}function bnpFromString(h,c){var e;if(c==16){e=4}else{if(c==8){e=3}else{if(c==256){e=8}else{if(c==2){e=1}else{if(c==32){e=5}else{if(c==4){e=2}else{this.fromRadix(h,c);return}}}}}}this.t=0;this.s=0;var g=h.length,d=false,f=0;while(--g>=0){var a=(e==8)?h[g]&255:intAt(h,g);if(a<0){if(h.charAt(g)=="-"){d=true}continue}d=false;if(f==0){this[this.t++]=a}else{if(f+e>this.DB){this[this.t-1]|=(a&((1<<(this.DB-f))-1))<<f;this[this.t++]=(a>>(this.DB-f))}else{this[this.t-1]|=a<<f}}f+=e;if(f>=this.DB){f-=this.DB}}if(e==8&&(h[0]&128)!=0){this.s=-1;if(f>0){this[this.t-1]|=((1<<(this.DB-f))-1)<<f}}this.clamp();if(d){BigInteger.ZERO.subTo(this,this)}}function bnpClamp(){var a=this.s&this.DM;while(this.t>0&&this[this.t-1]==a){--this.t}}function bnToString(c){if(this.s<0){return"-"+this.negate().toString(c)}var e;if(c==16){e=4}else{if(c==8){e=3}else{if(c==2){e=1}else{if(c==32){e=5}else{if(c==4){e=2}else{return this.toRadix(c)}}}}}var g=(1<<e)-1,l,a=false,h="",f=this.t;var j=this.DB-(f*this.DB)%e;if(f-->0){if(j<this.DB&&(l=this[f]>>j)>0){a=true;h=int2char(l)}while(f>=0){if(j<e){l=(this[f]&((1<<j)-1))<<(e-j);l|=this[--f]>>(j+=this.DB-e)}else{l=(this[f]>>(j-=e))&g;if(j<=0){j+=this.DB;--f}}if(l>0){a=true}if(a){h+=int2char(l)}}}return a?h:"0"}function bnNegate(){var a=nbi();BigInteger.ZERO.subTo(this,a);return a}function bnAbs(){return(this.s<0)?this.negate():this}function bnCompareTo(b){var d=this.s-b.s;if(d!=0){return d}var c=this.t;d=c-b.t;if(d!=0){return(this.s<0)?-d:d}while(--c>=0){if((d=this[c]-b[c])!=0){return d}}return 0}function nbits(a){var c=1,b;if((b=a>>>16)!=0){a=b;c+=16}if((b=a>>8)!=0){a=b;c+=8}if((b=a>>4)!=0){a=b;c+=4}if((b=a>>2)!=0){a=b;c+=2}if((b=a>>1)!=0){a=b;c+=1}return c}function bnBitLength(){if(this.t<=0){return 0}return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM))}function bnpDLShiftTo(c,b){var a;for(a=this.t-1;a>=0;--a){b[a+c]=this[a]}for(a=c-1;a>=0;--a){b[a]=0}b.t=this.t+c;b.s=this.s}function bnpDRShiftTo(c,b){for(var a=c;a<this.t;++a){b[a-c]=this[a]}b.t=Math.max(this.t-c,0);b.s=this.s}function bnpLShiftTo(j,e){var b=j%this.DB;var a=this.DB-b;var g=(1<<a)-1;var f=Math.floor(j/this.DB),h=(this.s<<b)&this.DM,d;for(d=this.t-1;d>=0;--d){e[d+f+1]=(this[d]>>a)|h;h=(this[d]&g)<<b}for(d=f-1;d>=0;--d){e[d]=0}e[f]=h;e.t=this.t+f+1;e.s=this.s;e.clamp()}function bnpRShiftTo(g,d){d.s=this.s;var e=Math.floor(g/this.DB);if(e>=this.t){d.t=0;return}var b=g%this.DB;var a=this.DB-b;var f=(1<<b)-1;d[0]=this[e]>>b;for(var c=e+1;c<this.t;++c){d[c-e-1]|=(this[c]&f)<<a;d[c-e]=this[c]>>b}if(b>0){d[this.t-e-1]|=(this.s&f)<<a}d.t=this.t-e;d.clamp()}function bnpSubTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]-d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g-=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g-=d[e];f[e++]=g&this.DM;g>>=this.DB}g-=d.s}f.s=(g<0)?-1:0;if(g<-1){f[e++]=this.DV+g}else{if(g>0){f[e++]=g}}f.t=e;f.clamp()}function bnpMultiplyTo(c,e){var b=this.abs(),f=c.abs();var d=b.t;e.t=d+f.t;while(--d>=0){e[d]=0}for(d=0;d<f.t;++d){e[d+b.t]=b.am(0,f[d],e,d,0,b.t)}e.s=0;e.clamp();if(this.s!=c.s){BigInteger.ZERO.subTo(e,e)}}function bnpSquareTo(d){var a=this.abs();var b=d.t=2*a.t;while(--b>=0){d[b]=0}for(b=0;b<a.t-1;++b){var e=a.am(b,a[b],d,2*b,0,1);if((d[b+a.t]+=a.am(b+1,2*a[b],d,2*b+1,e,a.t-b-1))>=a.DV){d[b+a.t]-=a.DV;d[b+a.t+1]=1}}if(d.t>0){d[d.t-1]+=a.am(b,a[b],d,2*b,0,1)}d.s=0;d.clamp()}function bnpDivRemTo(n,h,g){var x=n.abs();if(x.t<=0){return}var k=this.abs();if(k.t<x.t){if(h!=null){h.fromInt(0)}if(g!=null){this.copyTo(g)}return}if(g==null){g=nbi()}var d=nbi(),a=this.s,l=n.s;var w=this.DB-nbits(x[x.t-1]);if(w>0){x.lShiftTo(w,d);k.lShiftTo(w,g)}else{x.copyTo(d);k.copyTo(g)}var p=d.t;var b=d[p-1];if(b==0){return}var o=b*(1<<this.F1)+((p>1)?d[p-2]>>this.F2:0);var C=this.FV/o,B=(1<<this.F1)/o,A=1<<this.F2;var u=g.t,s=u-p,f=(h==null)?nbi():h;d.dlShiftTo(s,f);if(g.compareTo(f)>=0){g[g.t++]=1;g.subTo(f,g)}BigInteger.ONE.dlShiftTo(p,f);f.subTo(d,d);while(d.t<p){d[d.t++]=0}while(--s>=0){var c=(g[--u]==b)?this.DM:Math.floor(g[u]*C+(g[u-1]+A)*B);if((g[u]+=d.am(0,c,g,s,0,p))<c){d.dlShiftTo(s,f);g.subTo(f,g);while(g[u]<--c){g.subTo(f,g)}}}if(h!=null){g.drShiftTo(p,h);if(a!=l){BigInteger.ZERO.subTo(h,h)}}g.t=p;g.clamp();if(w>0){g.rShiftTo(w,g)}if(a<0){BigInteger.ZERO.subTo(g,g)}}function bnMod(b){var c=nbi();this.abs().divRemTo(b,null,c);if(this.s<0&&c.compareTo(BigInteger.ZERO)>0){b.subTo(c,c)}return c}function Classic(a){this.m=a}function cConvert(a){if(a.s<0||a.compareTo(this.m)>=0){return a.mod(this.m)}else{return a}}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}function cSqrTo(a,b){a.squareTo(b);this.reduce(b)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1){return 0}var a=this[0];if((a&1)==0){return 0}var b=a&3;b=(b*(2-(a&15)*b))&15;b=(b*(2-(a&255)*b))&255;b=(b*(2-(((a&65535)*b)&65535)))&65535;b=(b*(2-a*b%this.DV))%this.DV;return(b>0)?this.DV-b:-b}function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(a.DB-15))-1;this.mt2=2*a.t}function montConvert(a){var b=nbi();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);if(a.s<0&&b.compareTo(BigInteger.ZERO)>0){this.m.subTo(b,b)}return b}function montRevert(a){var b=nbi();a.copyTo(b);this.reduce(b);return b}function montReduce(a){while(a.t<=this.mt2){a[a.t++]=0}for(var c=0;c<this.m.t;++c){var b=a[c]&32767;var d=(b*this.mpl+(((b*this.mph+(a[c]>>15)*this.mpl)&this.um)<<15))&a.DM;b=c+this.m.t;a[b]+=this.m.am(0,d,a,c,0,this.m.t);while(a[b]>=a.DV){a[b]-=a.DV;a[++b]++}}a.clamp();a.drShiftTo(this.m.t,a);if(a.compareTo(this.m)>=0){a.subTo(this.m,a)}}function montSqrTo(a,b){a.squareTo(b);this.reduce(b)}function montMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return((this.t>0)?(this[0]&1):this.s)==0}function bnpExp(h,j){if(h>4294967295||h<1){return BigInteger.ONE}var f=nbi(),a=nbi(),d=j.convert(this),c=nbits(h)-1;d.copyTo(f);while(--c>=0){j.sqrTo(f,a);if((h&(1<<c))>0){j.mulTo(a,d,f)}else{var b=f;f=a;a=b}}return j.revert(f)}function bnModPowInt(b,a){var c;if(b<256||a.isEven()){c=new Classic(a)}else{c=new Montgomery(a)}return this.exp(b,c)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function Arcfour(){this.i=0;this.j=0;this.S=new Array()}function ARC4init(d){var c,a,b;for(c=0;c<256;++c){this.S[c]=c}a=0;for(c=0;c<256;++c){a=(a+this.S[c]+d[c%d.length])&255;b=this.S[c];this.S[c]=this.S[a];this.S[a]=b}this.i=0;this.j=0}function ARC4next(){var a;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;a=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=a;return this.S[(a+this.S[this.i])&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour()}var rng_psize=256;var rng_state;var rng_pool;var rng_pptr;function rng_seed_int(a){rng_pool[rng_pptr++]^=a&255;rng_pool[rng_pptr++]^=(a>>8)&255;rng_pool[rng_pptr++]^=(a>>16)&255;rng_pool[rng_pptr++]^=(a>>24)&255;if(rng_pptr>=rng_psize){rng_pptr-=rng_psize}}function rng_seed_time(){rng_seed_int(new Date().getTime())}if(rng_pool==null){rng_pool=new Array();rng_pptr=0;var t;if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t){rng_pool[rng_pptr++]=z.charCodeAt(t)&255}}while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t>>>8;rng_pool[rng_pptr++]=t&255}rng_pptr=0;rng_seed_time()}function rng_get_byte(){if(rng_state==null){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr){rng_pool[rng_pptr]=0}rng_pptr=0}return rng_state.next()}function rng_get_bytes(b){var a;for(a=0;a<b.length;++a){b[a]=rng_get_byte()}}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function pkcs1unpad2(g,j){var a=g.toByteArray();var f=0;while(f<a.length&&a[f]==0){++f}if(a.length-f!=j-1||a[f]!=2){return null}++f;while(a[f]!=0){if(++f>=a.length){return null}}var e="";while(++f<a.length){var h=a[f]&255;if(h<128){e+=String.fromCharCode(h)}else{if((h>191)&&(h<224)){e+=String.fromCharCode(((h&31)<<6)|(a[f+1]&63));++f}else{e+=String.fromCharCode(((h&15)<<12)|((a[f+1]&63)<<6)|(a[f+2]&63));f+=2}}}return e}function oaep_mgf1_str(c,a,e){var b="",d=0;while(b.length<a){b+=e(c+String.fromCharCode.apply(String,[(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255]));d+=1}return b}var SHA1_SIZE=20;function oaep_unpad(l,b,e){l=l.toByteArray();var f;for(f=0;f<l.length;f+=1){l[f]&=255}while(l.length<b){l.unshift(0)}l=String.fromCharCode.apply(String,l);if(l.length<2*SHA1_SIZE+2){throw"Cipher too short"}var c=l.substr(1,SHA1_SIZE);var o=l.substr(SHA1_SIZE+1);var m=oaep_mgf1_str(o,SHA1_SIZE,e||rstr_sha1);var h=[],f;for(f=0;f<c.length;f+=1){h[f]=c.charCodeAt(f)^m.charCodeAt(f)}var j=oaep_mgf1_str(String.fromCharCode.apply(String,h),l.length-SHA1_SIZE,rstr_sha1);var g=[];for(f=0;f<o.length;f+=1){g[f]=o.charCodeAt(f)^j.charCodeAt(f)}g=String.fromCharCode.apply(String,g);if(g.substr(0,SHA1_SIZE)!==rstr_sha1("")){throw"Hash mismatch"}g=g.substr(SHA1_SIZE);var a=g.indexOf("\x01");var k=(a!=-1)?g.substr(0,a).lastIndexOf("\x00"):-1;if(k+1!=a){throw"Malformed data"}return g.substr(a+1)}function RSASetPrivate(c,a,b){if(typeof c!=="string"){this.n=c;this.e=a;this.d=b}else{if(c!=null&&a!=null&&c.length>0&&a.length>0){this.n=parseBigInt(c,16);this.e=parseInt(a,16);this.d=parseBigInt(b,16)}else{alert("Invalid RSA private key")}}}function RSASetPrivateEx(g,d,e,c,b,a,h,f){if(g==null){throw"RSASetPrivateEx N == null"}if(d==null){throw"RSASetPrivateEx E == null"}if(g.length==0){throw"RSASetPrivateEx N.length == 0"}if(d.length==0){throw"RSASetPrivateEx E.length == 0"}if(g!=null&&d!=null&&g.length>0&&d.length>0){this.n=parseBigInt(g,16);this.e=parseInt(d,16);this.d=parseBigInt(e,16);this.p=parseBigInt(c,16);this.q=parseBigInt(b,16);this.dmp1=parseBigInt(a,16);this.dmq1=parseBigInt(h,16);this.coeff=parseBigInt(f,16)}else{alert("Invalid RSA private key in RSASetPrivateEx")}}function RSAGenerate(b,j){var a=new SecureRandom();var f=b>>1;this.e=parseInt(j,16);var c=new BigInteger(j,16);for(;;){for(;;){this.p=new BigInteger(b-f,1,a);if(this.p.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new BigInteger(f,1,a);if(this.q.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10)){break}}if(this.p.compareTo(this.q)<=0){var h=this.p;this.p=this.q;this.q=h}var g=this.p.subtract(BigInteger.ONE);var d=this.q.subtract(BigInteger.ONE);var e=g.multiply(d);if(e.gcd(c).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q);this.d=c.modInverse(e);this.dmp1=this.d.mod(g);this.dmq1=this.d.mod(d);this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(a){if(this.p==null||this.q==null){return a.modPow(this.d,this.n)}var c=a.mod(this.p).modPow(this.dmp1,this.p);var b=a.mod(this.q).modPow(this.dmq1,this.q);while(c.compareTo(b)<0){c=c.add(this.p)}return c.subtract(b).multiply(this.coeff).mod(this.p).multiply(this.q).add(b)}function RSADecrypt(b){var d=parseBigInt(b,16);var a=this.doPrivate(d);if(a==null){return null}return pkcs1unpad2(a,(this.n.bitLength()+7)>>3)}function RSADecryptOAEP(d,b){var e=parseBigInt(d,16);var a=this.doPrivate(e);if(a==null){return null}return oaep_unpad(a,(this.n.bitLength()+7)>>3,b)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt;RSAKey.prototype.decryptOAEP=RSADecryptOAEP;function parseBigInt(b,a){return new BigInteger(b,a)}function linebrk(c,d){var a="";var b=0;while(b+d<c.length){a+=c.substring(b,b+d)+"\n";b+=d}return a+c.substring(b,c.length)}function byte2Hex(a){if(a<16){return"0"+a.toString(16)}else{return a.toString(16)}}function pkcs1pad2(e,h){if(h<e.length+11){alert("Message too long for RSA");return null}var g=new Array();var d=e.length-1;while(d>=0&&h>0){var f=e.charCodeAt(d--);if(f<128){g[--h]=f}else{if((f>127)&&(f<2048)){g[--h]=(f&63)|128;g[--h]=(f>>6)|192}else{g[--h]=(f&63)|128;g[--h]=((f>>6)&63)|128;g[--h]=(f>>12)|224}}}g[--h]=0;var b=new SecureRandom();var a=new Array();while(h>2){a[0]=0;while(a[0]==0){b.nextBytes(a)}g[--h]=a[0]}g[--h]=2;g[--h]=0;return new BigInteger(g)}function oaep_mgf1_arr(c,a,e){var b="",d=0;while(b.length<a){b+=e(String.fromCharCode.apply(String,c.concat([(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255])));d+=1}return b}var SHA1_SIZE=20;function oaep_pad(l,a,c){if(l.length+2*SHA1_SIZE+2>a){throw"Message too long for RSA"}var h="",d;for(d=0;d<a-l.length-2*SHA1_SIZE-2;d+=1){h+="\x00"}var e=rstr_sha1("")+h+"\x01"+l;var f=new Array(SHA1_SIZE);new SecureRandom().nextBytes(f);var g=oaep_mgf1_arr(f,e.length,c||rstr_sha1);var k=[];for(d=0;d<e.length;d+=1){k[d]=e.charCodeAt(d)^g.charCodeAt(d)}var j=oaep_mgf1_arr(k,f.length,rstr_sha1);var b=[0];for(d=0;d<f.length;d+=1){b[d+1]=f[d]^j.charCodeAt(d)}return new BigInteger(b.concat(k))}function RSAKey(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}function RSASetPublic(b,a){if(typeof b!=="string"){this.n=b;this.e=a}else{if(b!=null&&a!=null&&b.length>0&&a.length>0){this.n=parseBigInt(b,16);this.e=parseInt(a,16)}else{alert("Invalid RSA public key")}}}function RSADoPublic(a){return a.modPowInt(this.e,this.n)}function RSAEncrypt(d){var a=pkcs1pad2(d,(this.n.bitLength()+7)>>3);if(a==null){return null}var e=this.doPublic(a);if(e==null){return null}var b=e.toString(16);if((b.length&1)==0){return b}else{return"0"+b}}function RSAEncryptOAEP(e,d){var a=oaep_pad(e,(this.n.bitLength()+7)>>3,d);if(a==null){return null}var f=this.doPublic(a);if(f==null){return null}var b=f.toString(16);if((b.length&1)==0){return b}else{return"0"+b}}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptOAEP=RSAEncryptOAEP;
/* rsapem-1.1.js (c) 2012 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
function _rsapem_pemToBase64(b){var a=b;a=a.replace("-----BEGIN RSA PRIVATE KEY-----","");a=a.replace("-----END RSA PRIVATE KEY-----","");a=a.replace(/[ \n]+/g,"");return a}function _rsapem_getPosArrayOfChildrenFromHex(d){var k=new Array();var l=ASN1HEX.getStartPosOfV_AtObj(d,0);var f=ASN1HEX.getPosOfNextSibling_AtObj(d,l);var h=ASN1HEX.getPosOfNextSibling_AtObj(d,f);var b=ASN1HEX.getPosOfNextSibling_AtObj(d,h);var m=ASN1HEX.getPosOfNextSibling_AtObj(d,b);var e=ASN1HEX.getPosOfNextSibling_AtObj(d,m);var g=ASN1HEX.getPosOfNextSibling_AtObj(d,e);var c=ASN1HEX.getPosOfNextSibling_AtObj(d,g);var j=ASN1HEX.getPosOfNextSibling_AtObj(d,c);k.push(l,f,h,b,m,e,g,c,j);return k}function _rsapem_getHexValueArrayOfChildrenFromHex(j){var r=_rsapem_getPosArrayOfChildrenFromHex(j);var s=ASN1HEX.getHexOfV_AtObj(j,r[0]);var f=ASN1HEX.getHexOfV_AtObj(j,r[1]);var k=ASN1HEX.getHexOfV_AtObj(j,r[2]);var l=ASN1HEX.getHexOfV_AtObj(j,r[3]);var c=ASN1HEX.getHexOfV_AtObj(j,r[4]);var b=ASN1HEX.getHexOfV_AtObj(j,r[5]);var h=ASN1HEX.getHexOfV_AtObj(j,r[6]);var g=ASN1HEX.getHexOfV_AtObj(j,r[7]);var m=ASN1HEX.getHexOfV_AtObj(j,r[8]);var o=new Array();o.push(s,f,k,l,c,b,h,g,m);return o}function _rsapem_readPrivateKeyFromASN1HexString(c){var b=_rsapem_getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}function _rsapem_readPrivateKeyFromPEMString(e){var c=_rsapem_pemToBase64(e);var d=b64tohex(c);var b=_rsapem_getHexValueArrayOfChildrenFromHex(d);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}RSAKey.prototype.readPrivateKeyFromPEMString=_rsapem_readPrivateKeyFromPEMString;RSAKey.prototype.readPrivateKeyFromASN1HexString=_rsapem_readPrivateKeyFromASN1HexString;
/* rsasign-1.2.2.js (c) 2012 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
var _RSASIGN_DIHEAD=[];_RSASIGN_DIHEAD.sha1="3021300906052b0e03021a05000414";_RSASIGN_DIHEAD.sha256="3031300d060960864801650304020105000420";_RSASIGN_DIHEAD.sha384="3041300d060960864801650304020205000430";_RSASIGN_DIHEAD.sha512="3051300d060960864801650304020305000440";_RSASIGN_DIHEAD.md2="3020300c06082a864886f70d020205000410";_RSASIGN_DIHEAD.md5="3020300c06082a864886f70d020505000410";_RSASIGN_DIHEAD.ripemd160="3021300906052b2403020105000414";var _RSASIGN_HASHHEXFUNC=[];_RSASIGN_HASHHEXFUNC.sha1=function(a){return KJUR.crypto.Util.sha1(a)};_RSASIGN_HASHHEXFUNC.sha256=function(a){return KJUR.crypto.Util.sha256(a)};_RSASIGN_HASHHEXFUNC.sha512=function(a){return KJUR.crypto.Util.sha512(a)};_RSASIGN_HASHHEXFUNC.md5=function(a){return KJUR.crypto.Util.md5(a)};_RSASIGN_HASHHEXFUNC.ripemd160=function(a){return KJUR.crypto.Util.ripemd160(a)};var _RE_HEXDECONLY=new RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi");function _rsasign_getHexPaddedDigestInfoForString(l,f,b){var c=f/4;var h=_RSASIGN_HASHHEXFUNC[b];var d=h(l);var a="0001";var j="00"+_RSASIGN_DIHEAD[b]+d;var g="";var k=c-a.length-j.length;for(var e=0;e<k;e+=2){g+="ff"}sPaddedMessageHex=a+g+j;return sPaddedMessageHex}function _zeroPaddingOfSignature(e,d){var c="";var a=d/4-e.length;for(var b=0;b<a;b++){c=c+"0"}return c+e}function _rsasign_signString(e,c){var f=_rsasign_getHexPaddedDigestInfoForString(e,this.n.bitLength(),c);var b=parseBigInt(f,16);var d=this.doPrivate(b);var a=d.toString(16);return _zeroPaddingOfSignature(a,this.n.bitLength())}function _rsasign_signStringWithSHA1(a){return _rsasign_signString.call(this,a,"sha1")}function _rsasign_signStringWithSHA256(a){return _rsasign_signString.call(this,a,"sha256")}function pss_mgf1_str(c,a,e){var b="",d=0;while(b.length<a){b+=e(c+String.fromCharCode.apply(String,[(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255]));d+=1}return b}function _rsasign_signStringPSS(q,a,k){var n=_RSASIGN_HASHRAWFUNC[a];var b=n(q);var g=b.length;var l=this.n.bitLength()-1;var c=Math.ceil(l/8);var d;if(k===-1){k=g}else{if((k===-2)||(k===undefined)){k=c-g-2}else{if(k<-2){throw"invalid salt length"}}}if(c<(g+k+2)){throw"data too long"}var f="";if(k>0){f=new Array(k);new SecureRandom().nextBytes(f);f=String.fromCharCode.apply(String,f)}var m=n("\x00\x00\x00\x00\x00\x00\x00\x00"+b+f);var j=[];for(d=0;d<c-k-g-2;d+=1){j[d]=0}var e=String.fromCharCode.apply(String,j)+"\x01"+f;var h=pss_mgf1_str(m,e.length,n);var p=[];for(d=0;d<e.length;d+=1){p[d]=e.charCodeAt(d)^h.charCodeAt(d)}var o=(65280>>(8*c-l))&255;p[0]&=~o;for(d=0;d<g;d++){p.push(m.charCodeAt(d))}p.push(188);return _zeroPaddingOfSignature(this.doPrivate(new BigInteger(p)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(a,d,c){var b=new RSAKey();b.setPublic(d,c);var e=b.doPublic(a);return e}function _rsasign_getHexDigestInfoFromSig(a,c,b){var e=_rsasign_getDecryptSignatureBI(a,c,b);var d=e.toString(16).replace(/^1f+00/,"");return d}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(f){for(var e in _RSASIGN_DIHEAD){var d=_RSASIGN_DIHEAD[e];var b=d.length;if(f.substring(0,b)==d){var c=[e,f.substring(b)];return c}}return[]}function _rsasign_verifySignatureWithArgs(f,b,g,k){var e=_rsasign_getHexDigestInfoFromSig(b,g,k);var h=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);if(h.length==0){return false}var d=h[0];var j=h[1];var a=_RSASIGN_HASHHEXFUNC[d];var c=a(f);return(j==c)}function _rsasign_verifyHexSignatureForMessage(c,b){var d=parseBigInt(c,16);var a=_rsasign_verifySignatureWithArgs(b,d,this.n.toString(16),this.e.toString(16));return a}function _rsasign_verifyString(f,k){k=k.replace(_RE_HEXDECONLY,"");if(k.length!=this.n.bitLength()/4){return 0}k=k.replace(/[ \n]+/g,"");var b=parseBigInt(k,16);var j=this.doPublic(b);var e=j.toString(16).replace(/^1f+00/,"");var g=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);if(g.length==0){return false}var d=g[0];var h=g[1];var a=_RSASIGN_HASHHEXFUNC[d];var c=a(f);return(h==c)}function _rsasign_verifyStringPSS(c,p,b,k){if(p.length!==this.n.bitLength()/4){return false}var o=_RSASIGN_HASHRAWFUNC[b];var d=o(c);var h=d.length;var m=this.n.bitLength()-1;var e=Math.ceil(m/8);var f;if(k===-1){k=h}else{if((k===-2)||(k===undefined)){k=e-h-2}else{if(k<-2){throw"invalid salt length"}}}if(e<(h+k+2)){throw"data too long"}var a=this.doPublic(parseBigInt(p,16)).toByteArray();for(f=0;f<a.length;f+=1){a[f]&=255}while(a.length<e){a.unshift(0)}if(a[e-1]!==188){throw"encoded message does not end in 0xbc"}a=String.fromCharCode.apply(String,a);var r=a.substr(0,e-h-1);var n=a.substr(r.length,h);var q=(65280>>(8*e-m))&255;if((r.charCodeAt(0)&q)!==0){throw"bits beyond keysize not zero"}var j=pss_mgf1_str(n,r.length,o);var g=[];for(f=0;f<r.length;f+=1){g[f]=r.charCodeAt(f)^j.charCodeAt(f)}g[0]&=~q;var l=e-h-k-2;for(f=0;f<l;f+=1){if(g[f]!==0){throw"leftmost octets not zero"}}if(g[l]!==1){throw"0x01 marker not found"}return n===o("\x00\x00\x00\x00\x00\x00\x00\x00"+d+String.fromCharCode.apply(String,g.slice(-k)))}RSAKey.prototype.signString=_rsasign_signString;RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.sign=_rsasign_signString;RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.signStringPSS=_rsasign_signStringPSS;RSAKey.prototype.signPSS=_rsasign_signStringPSS;RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.prototype.verifyString=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verify=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS;RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS;RSAKey.SALT_LEN_RECOVER=-2;var hexcase=0;var b64pad="";function hex_sha1(a){return rstr2hex(rstr_sha1(str2rstr_utf8(a)))}function b64_sha1(a){return rstr2b64(rstr_sha1(str2rstr_utf8(a)))}function any_sha1(a,b){return rstr2any(rstr_sha1(str2rstr_utf8(a)),b)}function hex_hmac_sha1(a,b){return rstr2hex(rstr_hmac_sha1(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_sha1(a,b){return rstr2b64(rstr_hmac_sha1(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_sha1(a,c,b){return rstr2any(rstr_hmac_sha1(str2rstr_utf8(a),str2rstr_utf8(c)),b)}function sha1_vm_test(){return hex_sha1("abc").toLowerCase()=="a9993e364706816aba3e25717850c26c9cd0d89d"}function rstr_sha1(a){return binb2rstr(binb_sha1(rstr2binb(a),a.length*8))}function rstr_hmac_sha1(c,f){var e=rstr2binb(c);if(e.length>16){e=binb_sha1(e,c.length*8)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binb_sha1(a.concat(rstr2binb(f)),512+f.length*8);return binb2rstr(binb_sha1(d.concat(g),512+160))}function rstr2hex(c){try{hexcase}catch(g){hexcase=0}var f=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=f.charAt((a>>>4)&15)+f.charAt(a&15)}return b}function rstr2b64(c){try{b64pad}catch(h){b64pad=""}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=c.length;for(var f=0;f<a;f+=3){var k=(c.charCodeAt(f)<<16)|(f+1<a?c.charCodeAt(f+1)<<8:0)|(f+2<a?c.charCodeAt(f+2):0);for(var d=0;d<4;d++){if(f*8+d*6>c.length*8){b+=b64pad}else{b+=g.charAt((k>>>6*(3-d))&63)}}}return b}function rstr2any(k,c){var b=c.length;var j=Array();var h,a,l,e;var g=Array(Math.ceil(k.length/2));for(h=0;h<g.length;h++){g[h]=(k.charCodeAt(h*2)<<8)|k.charCodeAt(h*2+1)}while(g.length>0){e=Array();l=0;for(h=0;h<g.length;h++){l=(l<<16)+g[h];a=Math.floor(l/b);l-=a*b;if(e.length>0||a>0){e[e.length]=a}}j[j.length]=l;g=e}var d="";for(h=j.length-1;h>=0;h--){d+=c.charAt(j[h])}var f=Math.ceil(k.length*8/(Math.log(c.length)/Math.log(2)));for(h=d.length;h<f;h++){d=c[0]+d}return d}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function str2rstr_utf16le(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode(b.charCodeAt(c)&255,(b.charCodeAt(c)>>>8)&255)}return a}function str2rstr_utf16be(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode((b.charCodeAt(c)>>>8)&255,b.charCodeAt(c)&255)}return a}function rstr2binb(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(var c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(24-c%32)}return a}function binb2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(24-c%32))&255)}return a}function binb_sha1(y,o){y[o>>5]|=128<<(24-o%32);y[((o+64>>9)<<4)+15]=o;var A=Array(80);var u=1732584193;var s=-271733879;var r=-1732584194;var q=271733878;var p=-1009589776;for(var l=0;l<y.length;l+=16){var n=u;var m=s;var k=r;var h=q;var f=p;for(var g=0;g<80;g++){if(g<16){A[g]=y[l+g]}else{A[g]=bit_rol(A[g-3]^A[g-8]^A[g-14]^A[g-16],1)}var B=safe_add(safe_add(bit_rol(u,5),sha1_ft(g,s,r,q)),safe_add(safe_add(p,A[g]),sha1_kt(g)));p=q;q=r;r=bit_rol(s,30);s=u;u=B}u=safe_add(u,n);s=safe_add(s,m);r=safe_add(r,k);q=safe_add(q,h);p=safe_add(p,f)}return Array(u,s,r,q,p)}function sha1_ft(e,a,g,f){if(e<20){return(a&g)|((~a)&f)}if(e<40){return a^g^f}if(e<60){return(a&g)|(a&f)|(g&f)}return a^g^f}function sha1_kt(a){return(a<20)?1518500249:(a<40)?1859775393:(a<60)?-1894007588:-899497514}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function bit_rol(a,b){return(a<<b)|(a>>>(32-b))}var hexcase=0;var b64pad="";function hex_sha256(a){return rstr2hex(rstr_sha256(str2rstr_utf8(a)))}function b64_sha256(a){return rstr2b64(rstr_sha256(str2rstr_utf8(a)))}function any_sha256(a,b){return rstr2any(rstr_sha256(str2rstr_utf8(a)),b)}function hex_hmac_sha256(a,b){return rstr2hex(rstr_hmac_sha256(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_sha256(a,b){return rstr2b64(rstr_hmac_sha256(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_sha256(a,c,b){return rstr2any(rstr_hmac_sha256(str2rstr_utf8(a),str2rstr_utf8(c)),b)}function sha256_vm_test(){return hex_sha256("abc").toLowerCase()=="ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad"}function rstr_sha256(a){return binb2rstr(binb_sha256(rstr2binb(a),a.length*8))}function rstr_hmac_sha256(c,f){var e=rstr2binb(c);if(e.length>16){e=binb_sha256(e,c.length*8)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binb_sha256(a.concat(rstr2binb(f)),512+f.length*8);return binb2rstr(binb_sha256(d.concat(g),512+256))}function rstr2hex(c){try{hexcase}catch(g){hexcase=0}var f=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=f.charAt((a>>>4)&15)+f.charAt(a&15)}return b}function rstr2b64(c){try{b64pad}catch(h){b64pad=""}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=c.length;for(var f=0;f<a;f+=3){var k=(c.charCodeAt(f)<<16)|(f+1<a?c.charCodeAt(f+1)<<8:0)|(f+2<a?c.charCodeAt(f+2):0);for(var d=0;d<4;d++){if(f*8+d*6>c.length*8){b+=b64pad}else{b+=g.charAt((k>>>6*(3-d))&63)}}}return b}function rstr2any(k,c){var b=c.length;var j=Array();var h,a,l,e;var g=Array(Math.ceil(k.length/2));for(h=0;h<g.length;h++){g[h]=(k.charCodeAt(h*2)<<8)|k.charCodeAt(h*2+1)}while(g.length>0){e=Array();l=0;for(h=0;h<g.length;h++){l=(l<<16)+g[h];a=Math.floor(l/b);l-=a*b;if(e.length>0||a>0){e[e.length]=a}}j[j.length]=l;g=e}var d="";for(h=j.length-1;h>=0;h--){d+=c.charAt(j[h])}var f=Math.ceil(k.length*8/(Math.log(c.length)/Math.log(2)));for(h=d.length;h<f;h++){d=c[0]+d}return d}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function str2rstr_utf16le(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode(b.charCodeAt(c)&255,(b.charCodeAt(c)>>>8)&255)}return a}function str2rstr_utf16be(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode((b.charCodeAt(c)>>>8)&255,b.charCodeAt(c)&255)}return a}function rstr2binb(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(var c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(24-c%32)}return a}function binb2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(24-c%32))&255)}return a}function sha256_S(b,a){return(b>>>a)|(b<<(32-a))}function sha256_R(b,a){return(b>>>a)}function sha256_Ch(a,c,b){return((a&c)^((~a)&b))}function sha256_Maj(a,c,b){return((a&c)^(a&b)^(c&b))}function sha256_Sigma0256(a){return(sha256_S(a,2)^sha256_S(a,13)^sha256_S(a,22))}function sha256_Sigma1256(a){return(sha256_S(a,6)^sha256_S(a,11)^sha256_S(a,25))}function sha256_Gamma0256(a){return(sha256_S(a,7)^sha256_S(a,18)^sha256_R(a,3))}function sha256_Gamma1256(a){return(sha256_S(a,17)^sha256_S(a,19)^sha256_R(a,10))}function sha256_Sigma0512(a){return(sha256_S(a,28)^sha256_S(a,34)^sha256_S(a,39))}function sha256_Sigma1512(a){return(sha256_S(a,14)^sha256_S(a,18)^sha256_S(a,41))}function sha256_Gamma0512(a){return(sha256_S(a,1)^sha256_S(a,8)^sha256_R(a,7))}function sha256_Gamma1512(a){return(sha256_S(a,19)^sha256_S(a,61)^sha256_R(a,6))}var sha256_K=new Array(1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998);function binb_sha256(n,o){var p=new Array(1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225);var k=new Array(64);var E,D,C,B,y,w,u,s;var r,q,A,x;n[o>>5]|=128<<(24-o%32);n[((o+64>>9)<<4)+15]=o;for(r=0;r<n.length;r+=16){E=p[0];D=p[1];C=p[2];B=p[3];y=p[4];w=p[5];u=p[6];s=p[7];for(q=0;q<64;q++){if(q<16){k[q]=n[q+r]}else{k[q]=safe_add(safe_add(safe_add(sha256_Gamma1256(k[q-2]),k[q-7]),sha256_Gamma0256(k[q-15])),k[q-16])}A=safe_add(safe_add(safe_add(safe_add(s,sha256_Sigma1256(y)),sha256_Ch(y,w,u)),sha256_K[q]),k[q]);x=safe_add(sha256_Sigma0256(E),sha256_Maj(E,D,C));s=u;u=w;w=y;y=safe_add(B,A);B=C;C=D;D=E;E=safe_add(A,x)}p[0]=safe_add(E,p[0]);p[1]=safe_add(D,p[1]);p[2]=safe_add(C,p[2]);p[3]=safe_add(B,p[3]);p[4]=safe_add(y,p[4]);p[5]=safe_add(w,p[5]);p[6]=safe_add(u,p[6]);p[7]=safe_add(s,p[7])}return p}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}var CryptoJS=CryptoJS||function(x,a){var o={},g=o.lib={},d=function(){},y=g.Base={extend:function(h){d.prototype=this;var f=new d;h&&f.mixIn(h);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var f=this.extend();f.init.apply(f,arguments);return f},init:function(){},mixIn:function(h){for(var f in h){h.hasOwnProperty(f)&&(this[f]=h[f])}h.hasOwnProperty("toString")&&(this.toString=h.toString)},clone:function(){return this.init.prototype.extend(this)}},w=g.WordArray=y.extend({init:function(h,f){h=this.words=h||[];this.sigBytes=f!=a?f:4*h.length},toString:function(f){return(f||C).stringify(this)},concat:function(h){var f=this.words,k=h.words,l=this.sigBytes;h=h.sigBytes;this.clamp();if(l%4){for(var j=0;j<h;j++){f[l+j>>>2]|=(k[j>>>2]>>>24-8*(j%4)&255)<<24-8*((l+j)%4)}}else{if(65535<k.length){for(j=0;j<h;j+=4){f[l+j>>>2]=k[j>>>2]}}else{f.push.apply(f,k)}}this.sigBytes+=h;return this},clamp:function(){var h=this.words,f=this.sigBytes;h[f>>>2]&=4294967295<<32-8*(f%4);h.length=x.ceil(f/4)},clone:function(){var f=y.clone.call(this);f.words=this.words.slice(0);return f},random:function(h){for(var f=[],j=0;j<h;j+=4){f.push(4294967296*x.random()|0)}return new w.init(f,h)}}),e=o.enc={},C=e.Hex={stringify:function(h){var f=h.words;h=h.sigBytes;for(var k=[],l=0;l<h;l++){var j=f[l>>>2]>>>24-8*(l%4)&255;k.push((j>>>4).toString(16));k.push((j&15).toString(16))}return k.join("")},parse:function(h){for(var f=h.length,j=[],k=0;k<f;k+=2){j[k>>>3]|=parseInt(h.substr(k,2),16)<<24-4*(k%8)}return new w.init(j,f/2)}},c=e.Latin1={stringify:function(h){var f=h.words;h=h.sigBytes;for(var j=[],k=0;k<h;k++){j.push(String.fromCharCode(f[k>>>2]>>>24-8*(k%4)&255))}return j.join("")},parse:function(h){for(var f=h.length,j=[],k=0;k<f;k++){j[k>>>2]|=(h.charCodeAt(k)&255)<<24-8*(k%4)}return new w.init(j,f)}},B=e.Utf8={stringify:function(h){try{return decodeURIComponent(escape(c.stringify(h)))}catch(f){throw Error("Malformed UTF-8 data")}},parse:function(f){return c.parse(unescape(encodeURIComponent(f)))}},b=g.BufferedBlockAlgorithm=y.extend({reset:function(){this._data=new w.init;this._nDataBytes=0},_append:function(f){"string"==typeof f&&(f=B.parse(f));this._data.concat(f);this._nDataBytes+=f.sigBytes},_process:function(j){var h=this._data,n=h.words,p=h.sigBytes,m=this.blockSize,l=p/(4*m),l=j?x.ceil(l):x.max((l|0)-this._minBufferSize,0);j=l*m;p=x.min(4*j,p);if(j){for(var k=0;k<j;k+=m){this._doProcessBlock(n,k)}k=n.splice(0,j);h.sigBytes-=p}return new w.init(k,p)},clone:function(){var f=y.clone.call(this);f._data=this._data.clone();return f},_minBufferSize:0});g.Hasher=b.extend({cfg:y.extend(),init:function(f){this.cfg=this.cfg.extend(f);this.reset()},reset:function(){b.reset.call(this);this._doReset()},update:function(f){this._append(f);this._process();return this},finalize:function(f){f&&this._append(f);return this._doFinalize()},blockSize:16,_createHelper:function(f){return function(h,j){return(new f.init(j)).finalize(h)}},_createHmacHelper:function(f){return function(h,j){return(new A.HMAC.init(f,j)).finalize(h)}}});var A=o.algo={};return o}(Math);(function(){var g=CryptoJS;var d=g.lib;var f=d.WordArray;var b=d.Hasher;var e=g.algo;var a=[];var c=e.SHA1=b.extend({_doReset:function(){this._hash=new f.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,j){var s=this._hash.words;var r=s[0];var q=s[1];var p=s[2];var o=s[3];var l=s[4];for(var k=0;k<80;k++){if(k<16){a[k]=m[j+k]|0}else{var h=a[k-3]^a[k-8]^a[k-14]^a[k-16];a[k]=(h<<1)|(h>>>31)}var u=((r<<5)|(r>>>27))+l+a[k];if(k<20){u+=((q&p)|(~q&o))+1518500249}else{if(k<40){u+=(q^p^o)+1859775393}else{if(k<60){u+=((q&p)|(q&o)|(p&o))-1894007588}else{u+=(q^p^o)-899497514}}}l=o;o=p;p=(q<<30)|(q>>>2);q=r;r=u}s[0]=(s[0]+r)|0;s[1]=(s[1]+q)|0;s[2]=(s[2]+p)|0;s[3]=(s[3]+o)|0;s[4]=(s[4]+l)|0},_doFinalize:function(){var k=this._data;var l=k.words;var h=this._nDataBytes*8;var j=k.sigBytes*8;l[j>>>5]|=128<<(24-j%32);l[(((j+64)>>>9)<<4)+14]=Math.floor(h/4294967296);l[(((j+64)>>>9)<<4)+15]=h;k.sigBytes=l.length*4;this._process();return this._hash},clone:function(){var h=b.clone.call(this);h._hash=this._hash.clone();return h}});g.SHA1=b._createHelper(c);g.HmacSHA1=b._createHmacHelper(c)}());var CryptoJS=CryptoJS||function(e,B){var n={},A=n.lib={},m=function(){},d=A.Base={extend:function(f){m.prototype=this;var g=new m;f&&g.mixIn(f);g.hasOwnProperty("init")||(g.init=function(){g.$super.init.apply(this,arguments)});g.init.prototype=g;g.$super=this;return g},create:function(){var f=this.extend();f.init.apply(f,arguments);return f},init:function(){},mixIn:function(f){for(var g in f){f.hasOwnProperty(g)&&(this[g]=f[g])}f.hasOwnProperty("toString")&&(this.toString=f.toString)},clone:function(){return this.init.prototype.extend(this)}},a=A.WordArray=d.extend({init:function(f,g){f=this.words=f||[];this.sigBytes=g!=B?g:4*f.length},toString:function(f){return(f||y).stringify(this)},concat:function(g){var k=this.words,j=g.words,f=this.sigBytes;g=g.sigBytes;this.clamp();if(f%4){for(var h=0;h<g;h++){k[f+h>>>2]|=(j[h>>>2]>>>24-8*(h%4)&255)<<24-8*((f+h)%4)}}else{if(65535<j.length){for(h=0;h<g;h+=4){k[f+h>>>2]=j[h>>>2]}}else{k.push.apply(k,j)}}this.sigBytes+=g;return this},clamp:function(){var f=this.words,g=this.sigBytes;f[g>>>2]&=4294967295<<32-8*(g%4);f.length=e.ceil(g/4)},clone:function(){var f=d.clone.call(this);f.words=this.words.slice(0);return f},random:function(f){for(var h=[],g=0;g<f;g+=4){h.push(4294967296*e.random()|0)}return new a.init(h,f)}}),r=n.enc={},y=r.Hex={stringify:function(g){var k=g.words;g=g.sigBytes;for(var j=[],f=0;f<g;f++){var h=k[f>>>2]>>>24-8*(f%4)&255;j.push((h>>>4).toString(16));j.push((h&15).toString(16))}return j.join("")},parse:function(g){for(var j=g.length,h=[],f=0;f<j;f+=2){h[f>>>3]|=parseInt(g.substr(f,2),16)<<24-4*(f%8)}return new a.init(h,j/2)}},c=r.Latin1={stringify:function(g){var j=g.words;g=g.sigBytes;for(var h=[],f=0;f<g;f++){h.push(String.fromCharCode(j[f>>>2]>>>24-8*(f%4)&255))}return h.join("")},parse:function(g){for(var j=g.length,h=[],f=0;f<j;f++){h[f>>>2]|=(g.charCodeAt(f)&255)<<24-8*(f%4)}return new a.init(h,j)}},b=r.Utf8={stringify:function(f){try{return decodeURIComponent(escape(c.stringify(f)))}catch(g){throw Error("Malformed UTF-8 data")}},parse:function(f){return c.parse(unescape(encodeURIComponent(f)))}},o=A.BufferedBlockAlgorithm=d.extend({reset:function(){this._data=new a.init;this._nDataBytes=0},_append:function(f){"string"==typeof f&&(f=b.parse(f));this._data.concat(f);this._nDataBytes+=f.sigBytes},_process:function(j){var s=this._data,q=s.words,h=s.sigBytes,l=this.blockSize,k=h/(4*l),k=j?e.ceil(k):e.max((k|0)-this._minBufferSize,0);j=k*l;h=e.min(4*j,h);if(j){for(var g=0;g<j;g+=l){this._doProcessBlock(q,g)}g=q.splice(0,j);s.sigBytes-=h}return new a.init(g,h)},clone:function(){var f=d.clone.call(this);f._data=this._data.clone();return f},_minBufferSize:0});A.Hasher=o.extend({cfg:d.extend(),init:function(f){this.cfg=this.cfg.extend(f);this.reset()},reset:function(){o.reset.call(this);this._doReset()},update:function(f){this._append(f);this._process();return this},finalize:function(f){f&&this._append(f);return this._doFinalize()},blockSize:16,_createHelper:function(f){return function(h,g){return(new f.init(g)).finalize(h)}},_createHmacHelper:function(f){return function(h,g){return(new p.HMAC.init(f,g)).finalize(h)}}});var p=n.algo={};return n}(Math);(function(m){for(var D=CryptoJS,o=D.lib,C=o.WordArray,n=o.Hasher,o=D.algo,e=[],b=[],A=function(f){return 4294967296*(f-(f|0))|0},B=2,d=0;64>d;){var c;p:{c=B;for(var r=m.sqrt(c),y=2;y<=r;y++){if(!(c%y)){c=!1;break p}}c=!0}c&&(8>d&&(e[d]=A(m.pow(B,0.5))),b[d]=A(m.pow(B,1/3)),d++);B++}var p=[],o=o.SHA256=n.extend({_doReset:function(){this._hash=new C.init(e.slice(0))},_doProcessBlock:function(K,J){for(var L=this._hash.words,I=L[0],H=L[1],u=L[2],F=L[3],q=L[4],E=L[5],x=L[6],w=L[7],s=0;64>s;s++){if(16>s){p[s]=K[J+s]|0}else{var a=p[s-15],G=p[s-2];p[s]=((a<<25|a>>>7)^(a<<14|a>>>18)^a>>>3)+p[s-7]+((G<<15|G>>>17)^(G<<13|G>>>19)^G>>>10)+p[s-16]}a=w+((q<<26|q>>>6)^(q<<21|q>>>11)^(q<<7|q>>>25))+(q&E^~q&x)+b[s]+p[s];G=((I<<30|I>>>2)^(I<<19|I>>>13)^(I<<10|I>>>22))+(I&H^I&u^H&u);w=x;x=E;E=q;q=F+a|0;F=u;u=H;H=I;I=a+G|0}L[0]=L[0]+I|0;L[1]=L[1]+H|0;L[2]=L[2]+u|0;L[3]=L[3]+F|0;L[4]=L[4]+q|0;L[5]=L[5]+E|0;L[6]=L[6]+x|0;L[7]=L[7]+w|0},_doFinalize:function(){var g=this._data,j=g.words,f=8*this._nDataBytes,h=8*g.sigBytes;j[h>>>5]|=128<<24-h%32;j[(h+64>>>9<<4)+14]=m.floor(f/4294967296);j[(h+64>>>9<<4)+15]=f;g.sigBytes=4*j.length;this._process();return this._hash},clone:function(){var f=n.clone.call(this);f._hash=this._hash.clone();return f}});D.SHA256=n._createHelper(o);D.HmacSHA256=n._createHmacHelper(o)})(Math);
/*
 * @file binding.js
 * @brief a "do all that's needed script"
 */
function hoba_binding(b,e){var j=hoba_make_auth_header();var d=document.getElementById("bindDuration").value;var a="no thanks";var h="";if(document.getElementById("contact")){h=document.getElementById("contact").value}if(b=="email"&&h==""){alert("You need to enter an email address");return}var f=new XMLHttpRequest();var c="/.well-known/hoba/binding";f.open("POST",c,true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.setRequestHeader("Authorization","HOBA "+j);f.onload=function(){document.getElementById(e).innerHTML=f.responseText};var g="btype="+b+"&duration="+d+"&scode="+a+"&ctype=email&contact="+h;f.send(g)}
/*
 * @file hoba-gen-key.js
 * @brief Javascript key generation used by hoba.js or worker.js
 */
function ah2bin(c){var b=new Array();for(i=0;2*i<c.length;++i){b[i]=parseInt(c.substring(2*i,2*i+2),16)}return b}function hoba_get_spki(c){var b=c.n.toString(16);var d=b.length*4;if(d==2048){var f="30820122300d06092a864886f70d01010105000382010f003082010a0282010100";var a="0203010001";var e=f+b+a}else{if(d==1024){var f="30819f300d06092a864886f70d010101050003818d0030818902818100";var a="0203010001";var e=f+b+a}else{return 0}}return e}function hoba_get_kid(b,d){var c=hoba_get_spki(b);var a;if(d==1){a=b64_sha1(c)}else{a=b64_sha256(c)}return a}function hoba_keylen_for_device(){if(navigator.userAgent){var a=navigator.userAgent;hobatext(a);if(a.match("iPhone")){return 1024}if(a.match("iPad")){return 1024}}return 1024}function hoba_gen_key(j,a){var b=hoba_keylen_for_device();hobatext("Generating a "+b+" bit RSA key pair");var f=new RSAKey();var g=new Date();f.generate(b,"10001");var c=new Date();var e=c-g;hobatext("Done generating that "+b+" bit RSA key pair (took "+e+"ms for that)");priv=f.n.toString(16)+":"+f.e.toString(16)+":"+f.d.toString(16);var d=new Object;d.state="new";d.alg=a;d.time=c;d.origin=j;d.priv=priv;d.kidalg=0;d.kid=hoba_get_kid(f,a);var h=JSON.stringify(d);return h}function urlb64(a){var b="";for(i=0;i<a.length;++i){if(a[i]=="+"){b+="-"}else{if(a[i]=="/"){b+="_"}else{b+=a[i]}}}return(b)}var challenge;var lastchaltime=0;function getnewchal(){var b=new Date();var f=b.getTime();var a=200000;var e=a/2;if((f-lastchaltime)>e){hobatext("background challenge");var d=new XMLHttpRequest();d.open("POST","/.well-known/hoba/getchal",false);d.onload=function(){if(d.readyState==4&&d.status==200&&d.getResponseHeader("HOBA")){challenge=d.getResponseHeader("HOBA").substring(5);b=new Date();lastchaltime=b.getTime()}};d.send(null)}if((f-lastchaltime)<a){hobatext("re-used challenge");return challenge}hobatext("synchronous challenge");var c=new XMLHttpRequest();c.open("POST","/.well-known/hoba/getchal",true);c.send(null);while(c.readyState!=4){}if(c.getResponseHeader("HOBA")){challenge=c.getResponseHeader("HOBA").substring(5);b=new Date();lastchaltime=b.getTime();return challenge}else{return false}}function make_auth_header_aux(k,c,b,j,g,h,a){var f=getnewchal();return make_auth_header_aux_chal(f,k,c,b,j,g,h,a)}function make_auth_header_aux_chal(y,j,x,q,p,u,w,s){var k=new Array();k.length=8;rng_get_bytes(k);var b=new BigInteger(k);var o=b.toString(16);var r=hex2b64(o);if(r.charAt(r.length-1)=="="){r=r.substring(0,r.length-1)}r=urlb64(r);var m="";var h=urlb64(s);var a=r+j+q+m+h+y;var l=new RSAKey();l.setPrivate(p,u,w);var c;if(j==1){c=l.signString(a,"sha1")}else{c=l.signString(a,"sha256")}var g=hex2b64(c);g=urlb64(g);var f='result="';f+=urlb64(s);f+=".";f+=y;f+=".";f+=r;f+=".";f+=g;f+='"';return f}
/*
 * @file hoba-ls.js
 * @brief Javascript API to hide localStorage
 */
function hoba_obsf(f){var d=get_tbsorigin();var e="dsafsd"+d+"sfnhd^&js";GibberishAES.size(128);var b=new Date();var a=b.getTime()+d;var c=GibberishAES.enc(f,e,a);return c}function hoba_deobsf(d){var b=get_tbsorigin();var c="dsafsd"+b+"sfnhd^&js";GibberishAES.size(128);var a=GibberishAES.dec(d,c);return a}var gkname="";var gknamedone=false;function hoba_keynam(){if(gknamedone&&gkname!=""){return gkname}var b=get_tbsorigin();var a="base64"+b+"base64isjustalaugh";a=hex2b64(a);gkname=a;gknamedone=true;return a}function hoba_setpriv(a){localStorage.setItem(hoba_keynam(),hoba_obsf(a))}function hoba_getpriv(){var a;var b=hoba_keynam();a=localStorage.getItem(b);if(a){return hoba_deobsf(a)}b+="=";a=localStorage.getItem(b);if(a){return hoba_deobsf(a)}b+="=";a=localStorage.getItem(b);if(a){return hoba_deobsf(a)}a=localStorage.getItem("priv:0");if(a){return a}a=localStorage.getItem("priv:1");if(a){return a}}function hoba_delpriv(){localStorage.removeItem(hoba_keynam());priv=localStorage.getItem("priv:0");priv=localStorage.getItem("priv:1")}(function(a,b){if(typeof exports==="object"){module.exports=b()}else{if(typeof define==="function"&&define.amd){define(b)}else{a.GibberishAES=b()}}}(this,function(){var p=14,y=8,g=false,V=function(W){try{return unescape(encodeURIComponent(W))}catch(X){throw"Error on UTF-8 encode"}},S=function(W){try{return decodeURIComponent(escape(W))}catch(X){throw ("Bad Key")}},I=function(Y){var Z=[],X,W;if(Y.length<16){X=16-Y.length;Z=[X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X]}for(W=0;W<Y.length;W++){Z[W]=Y[W]}return Z},l=function(aa,Y){var W="",Z,X;if(Y){Z=aa[15];if(Z>16){throw ("Decryption error: Maybe bad key")}if(Z===16){return""}for(X=0;X<16-Z;X++){W+=String.fromCharCode(aa[X])}}else{for(X=0;X<16;X++){W+=String.fromCharCode(aa[X])}}return W},s=function(Y){var W="",X;for(X=0;X<Y.length;X++){W+=(Y[X]<16?"0":"")+Y[X].toString(16)}return W},J=function(X){var W=[];X.replace(/(..)/g,function(Y){W.push(parseInt(Y,16))});return W},o=function(W,Z){var Y=[],X;if(!Z){W=V(W)}for(X=0;X<W.length;X++){Y[X]=W.charCodeAt(X)}return Y},d=function(W){switch(W){case 128:p=10;y=4;break;case 192:p=12;y=6;break;case 256:p=14;y=8;break;default:throw ("Invalid Key Size Specified:"+W)}},w=function(X){var W=[],Y;for(Y=0;Y<X;Y++){W=W.concat(Math.floor(Math.random()*256))}return W},r=function(aa,ac){var ad=p>=12?3:2,ab=[],Y=[],W=[],ae=[],X=aa.concat(ac),Z;W[0]=m(X);ae=W[0];for(Z=1;Z<ad;Z++){W[Z]=m(W[Z-1].concat(X));ae=ae.concat(W[Z])}ab=ae.slice(0,4*y);Y=ae.slice(4*y,4*y+16);return{key:ab,iv:Y}},c=function(aa,Z,X){Z=N(Z);var ac=Math.ceil(aa.length/16),ab=[],Y,W=[];for(Y=0;Y<ac;Y++){ab[Y]=I(aa.slice(Y*16,Y*16+16))}if(aa.length%16===0){ab.push([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]);ac++}for(Y=0;Y<ab.length;Y++){ab[Y]=(Y===0)?H(ab[Y],X):H(ab[Y],W[Y-1]);W[Y]=e(ab[Y],Z)}return W},D=function(ac,ad,Y,Z){ad=N(ad);var ae=ac.length/16,X=[],aa,W=[],ab="";for(aa=0;aa<ae;aa++){X.push(ac.slice(aa*16,(aa+1)*16))}for(aa=X.length-1;aa>=0;aa--){W[aa]=M(X[aa],ad);W[aa]=(aa===0)?H(W[aa],Y):H(W[aa],X[aa-1])}for(aa=0;aa<ae-1;aa++){ab+=l(W[aa])}ab+=l(W[aa],true);return Z?ab:S(ab)},e=function(Z,Y){g=false;var X=Q(Z,Y,0),W;for(W=1;W<(p+1);W++){X=R(X);X=a(X);if(W<p){X=U(X)}X=Q(X,Y,W)}return X},M=function(Z,Y){g=true;var X=Q(Z,Y,p),W;for(W=p-1;W>-1;W--){X=a(X);X=R(X);X=Q(X,Y,W);if(W>0){X=U(X)}}return X},R=function(Z){var Y=g?G:T,W=[],X;for(X=0;X<16;X++){W[X]=Y[Z[X]]}return W},a=function(Z){var W=[],Y=g?[0,13,10,7,4,1,14,11,8,5,2,15,12,9,6,3]:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11],X;for(X=0;X<16;X++){W[X]=Z[Y[X]]}return W},U=function(X){var W=[],Y;if(!g){for(Y=0;Y<4;Y++){W[Y*4]=E[X[Y*4]]^f[X[1+Y*4]]^X[2+Y*4]^X[3+Y*4];W[1+Y*4]=X[Y*4]^E[X[1+Y*4]]^f[X[2+Y*4]]^X[3+Y*4];W[2+Y*4]=X[Y*4]^X[1+Y*4]^E[X[2+Y*4]]^f[X[3+Y*4]];W[3+Y*4]=f[X[Y*4]]^X[1+Y*4]^X[2+Y*4]^E[X[3+Y*4]]}}else{for(Y=0;Y<4;Y++){W[Y*4]=n[X[Y*4]]^k[X[1+Y*4]]^L[X[2+Y*4]]^h[X[3+Y*4]];W[1+Y*4]=h[X[Y*4]]^n[X[1+Y*4]]^k[X[2+Y*4]]^L[X[3+Y*4]];W[2+Y*4]=L[X[Y*4]]^h[X[1+Y*4]]^n[X[2+Y*4]]^k[X[3+Y*4]];W[3+Y*4]=k[X[Y*4]]^L[X[1+Y*4]]^h[X[2+Y*4]]^n[X[3+Y*4]]}}return W},Q=function(Z,aa,X){var W=[],Y;for(Y=0;Y<16;Y++){W[Y]=Z[Y]^aa[X][Y]}return W},H=function(Z,Y){var W=[],X;for(X=0;X<16;X++){W[X]=Z[X]^Y[X]}return W},N=function(ab){var W=[],X=[],aa,ac,Z,ad=[],Y;for(aa=0;aa<y;aa++){ac=[ab[4*aa],ab[4*aa+1],ab[4*aa+2],ab[4*aa+3]];W[aa]=ac}for(aa=y;aa<(4*(p+1));aa++){W[aa]=[];for(Z=0;Z<4;Z++){X[Z]=W[aa-1][Z]}if(aa%y===0){X=B(A(X));X[0]^=O[aa/y-1]}else{if(y>6&&aa%y===4){X=B(X)}}for(Z=0;Z<4;Z++){W[aa][Z]=W[aa-y][Z]^X[Z]}}for(aa=0;aa<(p+1);aa++){ad[aa]=[];for(Y=0;Y<4;Y++){ad[aa].push(W[aa*4+Y][0],W[aa*4+Y][1],W[aa*4+Y][2],W[aa*4+Y][3])}}return ad},B=function(W){for(var X=0;X<4;X++){W[X]=T[W[X]]}return W},A=function(W){var Y=W[0],X;for(X=0;X<4;X++){W[X]=W[X+1]}W[3]=Y;return W},b=function(Z,Y){var X,W=[];for(X=0;X<Z.length;X+=Y){W[X/Y]=parseInt(Z.substr(X,Y),16)}return W},j=function(W){var Y,X=[];for(Y=0;Y<W.length;Y++){X[W[Y]]=Y}return X},q=function(X,W){var Z,Y;Y=0;for(Z=0;Z<8;Z++){Y=((W&1)===1)?Y^X:Y;X=(X>127)?283^(X<<1):(X<<1);W>>>=1}return Y},F=function(W){var X,Y=[];for(X=0;X<256;X++){Y[X]=q(W,X)}return Y},T=b("637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0b7fd9326363ff7cc34a5e5f171d8311504c723c31896059a071280e2eb27b27509832c1a1b6e5aa0523bd6b329e32f8453d100ed20fcb15b6acbbe394a4c58cfd0efaafb434d338545f9027f503c9fa851a3408f929d38f5bcb6da2110fff3d2cd0c13ec5f974417c4a77e3d645d197360814fdc222a908846eeb814de5e0bdbe0323a0a4906245cc2d3ac629195e479e7c8376d8dd54ea96c56f4ea657aae08ba78252e1ca6b4c6e8dd741f4bbd8b8a703eb5664803f60e613557b986c11d9ee1f8981169d98e949b1e87e9ce5528df8ca1890dbfe6426841992d0fb054bb16",2),G=j(T),O=b("01020408102040801b366cd8ab4d9a2f5ebc63c697356ad4b37dfaefc591",2),E=F(2),f=F(3),h=F(9),k=F(11),L=F(13),n=F(14),u=function(aa,ad,Y){var Z=w(8),ac=r(o(ad,Y),Z),ae=ac.key,X=ac.iv,W,ab=[[83,97,108,116,101,100,95,95].concat(Z)];aa=o(aa,Y);W=c(aa,ae,X);W=ab.concat(W);return P.encode(W)},x=function(Y,ab,ad){var X=P.decode(Y),aa=X.slice(8,16),ac=r(o(ab,ad),aa),Z=ac.key,W=ac.iv;X=X.slice(16,X.length);Y=D(X,Z,W,ad);return Y},m=function(aa){function Z(aw,av){return(aw<<av)|(aw>>>(32-av))}function af(az,aw){var aB,av,ay,aA,ax;ay=(az&2147483648);aA=(aw&2147483648);aB=(az&1073741824);av=(aw&1073741824);ax=(az&1073741823)+(aw&1073741823);if(aB&av){return(ax^2147483648^ay^aA)}if(aB|av){if(ax&1073741824){return(ax^3221225472^ay^aA)}else{return(ax^1073741824^ay^aA)}}else{return(ax^ay^aA)}}function ao(av,ax,aw){return(av&ax)|((~av)&aw)}function an(av,ax,aw){return(av&aw)|(ax&(~aw))}function am(av,ax,aw){return(av^ax^aw)}function ab(av,ax,aw){return(ax^(av|(~aw)))}function ah(ax,aw,aB,aA,av,ay,az){ax=af(ax,af(af(ao(aw,aB,aA),av),az));return af(Z(ax,ay),aw)}function aq(ax,aw,aB,aA,av,ay,az){ax=af(ax,af(af(an(aw,aB,aA),av),az));return af(Z(ax,ay),aw)}function Y(ax,aw,aB,aA,av,ay,az){ax=af(ax,af(af(am(aw,aB,aA),av),az));return af(Z(ax,ay),aw)}function ag(ax,aw,aB,aA,av,ay,az){ax=af(ax,af(af(ab(aw,aB,aA),av),az));return af(Z(ax,ay),aw)}function ai(aB){var aC,ay=aB.length,ax=ay+8,aw=(ax-(ax%64))/64,aA=(aw+1)*16,aD=[],av=0,az=0;while(az<ay){aC=(az-(az%4))/4;av=(az%4)*8;aD[aC]=(aD[aC]|(aB[az]<<av));az++}aC=(az-(az%4))/4;av=(az%4)*8;aD[aC]=aD[aC]|(128<<av);aD[aA-2]=ay<<3;aD[aA-1]=ay>>>29;return aD}function W(ax){var ay,av,aw=[];for(av=0;av<=3;av++){ay=(ax>>>(av*8))&255;aw=aw.concat(ay)}return aw}var ae=[],ak,al,X,ad,aj,au,at,ar,ap,ac=b("67452301efcdab8998badcfe10325476d76aa478e8c7b756242070dbc1bdceeef57c0faf4787c62aa8304613fd469501698098d88b44f7afffff5bb1895cd7be6b901122fd987193a679438e49b40821f61e2562c040b340265e5a51e9b6c7aad62f105d02441453d8a1e681e7d3fbc821e1cde6c33707d6f4d50d87455a14eda9e3e905fcefa3f8676f02d98d2a4c8afffa39428771f6816d9d6122fde5380ca4beea444bdecfa9f6bb4b60bebfbc70289b7ec6eaa127fad4ef308504881d05d9d4d039e6db99e51fa27cf8c4ac5665f4292244432aff97ab9423a7fc93a039655b59c38f0ccc92ffeff47d85845dd16fa87e4ffe2ce6e0a30143144e0811a1f7537e82bd3af2352ad7d2bbeb86d391",8);ae=ai(aa);au=ac[0];at=ac[1];ar=ac[2];ap=ac[3];for(ak=0;ak<ae.length;ak+=16){al=au;X=at;ad=ar;aj=ap;au=ah(au,at,ar,ap,ae[ak+0],7,ac[4]);ap=ah(ap,au,at,ar,ae[ak+1],12,ac[5]);ar=ah(ar,ap,au,at,ae[ak+2],17,ac[6]);at=ah(at,ar,ap,au,ae[ak+3],22,ac[7]);au=ah(au,at,ar,ap,ae[ak+4],7,ac[8]);ap=ah(ap,au,at,ar,ae[ak+5],12,ac[9]);ar=ah(ar,ap,au,at,ae[ak+6],17,ac[10]);at=ah(at,ar,ap,au,ae[ak+7],22,ac[11]);au=ah(au,at,ar,ap,ae[ak+8],7,ac[12]);ap=ah(ap,au,at,ar,ae[ak+9],12,ac[13]);ar=ah(ar,ap,au,at,ae[ak+10],17,ac[14]);at=ah(at,ar,ap,au,ae[ak+11],22,ac[15]);au=ah(au,at,ar,ap,ae[ak+12],7,ac[16]);ap=ah(ap,au,at,ar,ae[ak+13],12,ac[17]);ar=ah(ar,ap,au,at,ae[ak+14],17,ac[18]);at=ah(at,ar,ap,au,ae[ak+15],22,ac[19]);au=aq(au,at,ar,ap,ae[ak+1],5,ac[20]);ap=aq(ap,au,at,ar,ae[ak+6],9,ac[21]);ar=aq(ar,ap,au,at,ae[ak+11],14,ac[22]);at=aq(at,ar,ap,au,ae[ak+0],20,ac[23]);au=aq(au,at,ar,ap,ae[ak+5],5,ac[24]);ap=aq(ap,au,at,ar,ae[ak+10],9,ac[25]);ar=aq(ar,ap,au,at,ae[ak+15],14,ac[26]);at=aq(at,ar,ap,au,ae[ak+4],20,ac[27]);au=aq(au,at,ar,ap,ae[ak+9],5,ac[28]);ap=aq(ap,au,at,ar,ae[ak+14],9,ac[29]);ar=aq(ar,ap,au,at,ae[ak+3],14,ac[30]);at=aq(at,ar,ap,au,ae[ak+8],20,ac[31]);au=aq(au,at,ar,ap,ae[ak+13],5,ac[32]);ap=aq(ap,au,at,ar,ae[ak+2],9,ac[33]);ar=aq(ar,ap,au,at,ae[ak+7],14,ac[34]);at=aq(at,ar,ap,au,ae[ak+12],20,ac[35]);au=Y(au,at,ar,ap,ae[ak+5],4,ac[36]);ap=Y(ap,au,at,ar,ae[ak+8],11,ac[37]);ar=Y(ar,ap,au,at,ae[ak+11],16,ac[38]);at=Y(at,ar,ap,au,ae[ak+14],23,ac[39]);au=Y(au,at,ar,ap,ae[ak+1],4,ac[40]);ap=Y(ap,au,at,ar,ae[ak+4],11,ac[41]);ar=Y(ar,ap,au,at,ae[ak+7],16,ac[42]);at=Y(at,ar,ap,au,ae[ak+10],23,ac[43]);au=Y(au,at,ar,ap,ae[ak+13],4,ac[44]);ap=Y(ap,au,at,ar,ae[ak+0],11,ac[45]);ar=Y(ar,ap,au,at,ae[ak+3],16,ac[46]);at=Y(at,ar,ap,au,ae[ak+6],23,ac[47]);au=Y(au,at,ar,ap,ae[ak+9],4,ac[48]);ap=Y(ap,au,at,ar,ae[ak+12],11,ac[49]);ar=Y(ar,ap,au,at,ae[ak+15],16,ac[50]);at=Y(at,ar,ap,au,ae[ak+2],23,ac[51]);au=ag(au,at,ar,ap,ae[ak+0],6,ac[52]);ap=ag(ap,au,at,ar,ae[ak+7],10,ac[53]);ar=ag(ar,ap,au,at,ae[ak+14],15,ac[54]);at=ag(at,ar,ap,au,ae[ak+5],21,ac[55]);au=ag(au,at,ar,ap,ae[ak+12],6,ac[56]);ap=ag(ap,au,at,ar,ae[ak+3],10,ac[57]);ar=ag(ar,ap,au,at,ae[ak+10],15,ac[58]);at=ag(at,ar,ap,au,ae[ak+1],21,ac[59]);au=ag(au,at,ar,ap,ae[ak+8],6,ac[60]);ap=ag(ap,au,at,ar,ae[ak+15],10,ac[61]);ar=ag(ar,ap,au,at,ae[ak+6],15,ac[62]);at=ag(at,ar,ap,au,ae[ak+13],21,ac[63]);au=ag(au,at,ar,ap,ae[ak+4],6,ac[64]);ap=ag(ap,au,at,ar,ae[ak+11],10,ac[65]);ar=ag(ar,ap,au,at,ae[ak+2],15,ac[66]);at=ag(at,ar,ap,au,ae[ak+9],21,ac[67]);au=af(au,al);at=af(at,X);ar=af(ar,ad);ap=af(ap,aj)}return W(au).concat(W(at),W(ar),W(ap))},K=function(ab,aa,X){var Z;ab=o(ab);aa=o(aa);for(Z=aa.length;Z<32;Z++){aa[Z]=0}if(X===undefined){}else{X=o(X);for(Z=X.length;Z<16;Z++){X[Z]=0}}var Y=c(ab,aa,X);var W=[X];for(Z=0;Z<Y.length;Z++){W[W.length]=Y[Z]}return P.encode(W)},C=function(ab,aa){var Z=P.decode(ab);var W=Z.slice(0,16);var Y=Z.slice(16,Z.length);var X;aa=o(aa);for(X=aa.length;X<32;X++){aa[X]=0}var ac=D(Y,aa,W,false);return ac},P=(function(){var W="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y=W.split(""),X=function(aa,af){var ag=[],ae="",ad,ac,ab=Math.floor(aa.length*16/3);for(ad=0;ad<aa.length*16;ad++){ag.push(aa[Math.floor(ad/16)][ad%16])}for(ad=0;ad<ag.length;ad=ad+3){ae+=Y[ag[ad]>>2];ae+=Y[((ag[ad]&3)<<4)|(ag[ad+1]>>4)];if(ag[ad+1]!==undefined){ae+=Y[((ag[ad+1]&15)<<2)|(ag[ad+2]>>6)]}else{ae+="="}if(ag[ad+2]!==undefined){ae+=Y[ag[ad+2]&63]}else{ae+="="}}ac=ae.slice(0,64)+"\n";for(ad=1;ad<(Math.ceil(ae.length/64));ad++){ac+=ae.slice(ad*64,ad*64+64)+(Math.ceil(ae.length/64)===ad+1?"":"\n")}return ac},Z=function(ab){ab=ab.replace(/\n/g,"");var ad=[],ae=[],aa=[],ac;for(ac=0;ac<ab.length;ac=ac+4){ae[0]=W.indexOf(ab.charAt(ac));ae[1]=W.indexOf(ab.charAt(ac+1));ae[2]=W.indexOf(ab.charAt(ac+2));ae[3]=W.indexOf(ab.charAt(ac+3));aa[0]=(ae[0]<<2)|(ae[1]>>4);aa[1]=((ae[1]&15)<<4)|(ae[2]>>2);aa[2]=((ae[2]&3)<<6)|ae[3];ad.push(aa[0],aa[1],aa[2])}ad=ad.slice(0,ad.length-(ad.length%16));return ad};if(typeof Array.indexOf==="function"){W=Y}return{encode:X,decode:Z}})();return{size:d,h2a:J,expandKey:N,encryptBlock:e,decryptBlock:M,Decrypt:g,s2a:o,rawEncrypt:c,rawDecrypt:D,dec:x,openSSLKey:r,a2h:s,enc:u,Hash:{MD5:m},Base64:P}}));
/*
 * @file hoba.js
 * @brief Javascript external i/f for HOBA
 */
var regreq=new Object;var unregreq=new Object;var privstruct=new Object;var authreq=new Object;var worker=new Object;var keygenfails=0;var ismsie=false;var workerok=false;var bgsigning=true;var cachedsig="";var cachedsigtime=new Date(1970);var maxchalwindow=200000;function dscr(){return"\n"+Date()+" "}function replacer(c,f){var e=document.getElementById(c);var d=document.createElement();d.innerHTML=f;var a=e.firstChild;var b=e.replaceChild(d,a);return}function mshobatext(d){var c=document.getElementById("hobatext");var a=c.innerText;var b=dscr()+d+a;c.innerText=b;return}function hobatext(b){if(ismsie){mshobatext(b);return}var a=document.getElementById("hobatext");if(a!=null){a.innerHTML=dscr()+b+a.innerHTML}hoba_show_state();return}function clearhobatext(b){var a=document.getElementById("hobatext");if(a!=null){a.innerHTML=""}return}function hoba_put_key(a,b,f){var d=JSON.stringify(b);try{hoba_setpriv(d)}catch(c){hobatext("Storage exception")}return true}function hoba_get_key(b,f){var e="priv:"+f;if(typeof(localStorage)=="undefined"){return false}var d=hoba_getpriv();if(d==null){if(ismsie||(worker==null||keygenfails>10)){d=hoba_gen_key(b,f);if(d!=false){hoba_setpriv(d)}else{return false}}else{keygenfails++;return false}}var a=JSON.parse(d);var c=a.priv.split(":");a.n=c[0];a.e=c[1];a.d=c[2];a.rsa=new RSASetPrivate(a.n,a.e,a.d);return a}function regcallback(){if(regreq.readyState==4&&regreq.status==200){hobatext(regreq.responseText);privstruct.state="regok";privstruct.time=new Date();hoba_put_key(privstruct.origin,privstruct,privstruct.alg)}else{if(regreq.readyState==4&&regreq.status>=400){privstruct.state="reginwork";privstruct.time=new Date();hoba_put_key(privstruct.origin,privstruct,privstruct.alg);hobatext(regreq.responseText)}}hoba_show_state()}function unregcallback(){if(unregreq.readyState==4&&unregreq.status==200){hobatext(unregreq.responseText)}else{if(regreq.readyState==4&&regreq.status>=400){hobatext(unregreq.responseText)}}hoba_show_state()}function authcallback(){if(authreq.readyState==4&&authreq.status==200){hobatext(authreq.responseText)}else{if(authreq.readyState==4&&authreq.status>=400){hobatext("HTTP-"+authreq.status+": "+authreq.responseText)}}hoba_show_state()}function add0D0As(b){var a="";for(i=0;i!=b.length;i++){a+=b[i];if(i&&((i%64)==0)){a+="%0D%0A"}}return a}function get_tbsorigin(){var b=location;var a=b.protocol;if(a.charAt(a.length-1)==":"){a=a.substring(0,a.length-1)}a+="://"+b.hostname;if(b.port===null||b.port==null||b.port==""){if(b.protocol=="http:"){a+=":80"}else{if(b.protocol=="https:"){a+=":443"}}}else{a+=":"+b.port}return a}function get_origin(){var c=location;var b=c.protocol+"://"+c.hostname+":"+c.port;var c=location;var b=c.protocol+"://"+c.hostname+":"+c.port;var a=c.protocol;if(a.charAt(a.length-1)==":"){a=a.substring(0,a.length-1)}a+=c.hostname;if(c.port===null||c.port==null||c.port==""){if(c.protocol=="http:"){b=c.protocol+c.hostname+":80";a+="80"}else{if(c.protocol=="https:"){b=c.protocol+c.hostname+":443";a+="443"}else{b=c.protocol+c.hostname+":0"}}}return b}function hoba_make_auth_header(){return hoba_make_auth_header_chal(null)}function hoba_make_auth_header_chal(j){var d=false;var h=get_origin();var f=get_tbsorigin();var e;if(workerok&&bgsigning){var b=new Date();var c=b.getTime()-cachedsigtime.getTime();if(cachedsig!=""&&c<maxchalwindow){hobatext("using signature that's "+c+"ms old");e=cachedsig;cachedsig="";cachedsigtime=new Date();d=true}}var a=0;privstruct=hoba_get_key(h,a);if(privstruct==false){hobatext("waiting for key generation");return false}if(!d){if(j!=null){e=make_auth_header_aux_chal(j,a,h,f,privstruct.n,privstruct.e,privstruct.d,urlb64(privstruct.kid))}else{e=make_auth_header_aux(a,h,f,privstruct.n,privstruct.e,privstruct.d,urlb64(privstruct.kid))}}else{hobatext("handed private to worker");var g={cmd:"bgsign",alg:a,origin:h,tbsorigin:f,n:privstruct.n,e:privstruct.e,d:privstruct.d,kid:urlb64(privstruct.kid)};setTimeout(worker.postMessage(g),2000)}return e}function hoba_login(){var a=ReadCookie("HOBAState");if(a=="Loggedin"){return}var c=hoba_make_auth_header();authreq=new XMLHttpRequest();var b="/.well-known/hoba/login";authreq.onreadystatechange=authcallback;authreq.open("POST",b,true);authreq.setRequestHeader("Authorization","HOBA "+c);authreq.send(null)}function hoba_logout(){var b=hoba_make_auth_header();authreq=new XMLHttpRequest();var a="/.well-known/hoba/logout";authreq.onreadystatechange=authcallback;authreq.open("POST",a,true);authreq.setRequestHeader("Authorization","HOBA "+b);authreq.send(null)}function hoba_register(){var a=0;var h=get_origin();var g=get_tbsorigin();privstruct=hoba_get_key(h,a);if(!ismsie&&privstruct==false){hobatext("waiting key generation completion - will try again in a second");setTimeout(hoba_register,1000);return false}if(privstruct.state!="new"&&privstruct.state!="reginwork"){if(privstruct.state="regok"){hobatext("Already registered dude.")}else{hobatext("Weirdness in registration.")}return}var c="-----BEGIN PUBLIC KEY-----";var f=urlb64(hex2b64(hoba_get_spki(privstruct.rsa)));f=add0D0As(f);var d="-----END PUBLIC KEY-----";var b=c+"%0D%0A"+f+"%0D%0A"+d;var e="&kidtype="+privstruct.kidalg+"&kidval="+urlb64(privstruct.kid)+"&didtype=2&didval=youpick&pub="+b;regreq=new XMLHttpRequest();var j="/.well-known/hoba/register";regreq.onreadystatechange=regcallback;regreq.open("POST",j,true);regreq.setRequestHeader("Content-type","application/x-www-form-urlencoded");var k=hoba_make_auth_header();regreq.setRequestHeader("Authorization","HOBA "+k);regreq.send(e)}function hoba_getmykid(){var b=0;var a="Somewhere";privstruct=hoba_get_key(a,b);return privstruct.kid}function hoba_checkUA(){var h=navigator.appName;if(h=="Microsoft Internet Explorer"){ismsie=true}clearhobatext();hobatext("Checking browser is HOBA compatible...");var d=false;var b="";try{var f=false;if(localStorage){localStorage.setItem("hoba_test","hoba_test");var l=localStorage.getItem("hoba_test");if(l!="hoba_test"){b="write/read error"}else{f=true;localStorage.removeItem("hoba_test")}}if(f){b="worker problem"}d=f;if(!ismsie&&window.Worker){worker=new Worker("/js/worker-min.js");if(worker){worker.addEventListener("message",function(o){var n=o.data;if(n.iskey){hoba_setpriv(n.key);hobatext("Key stored.")}else{if(n.issig){cachedsig=n.sig;cachedsigtime=new Date();hobatext("Got sig from worker")}else{if(n.msg){hobatext("Worker said: "+n.msg)}else{hobatext("garbled worker msg: "+o.data)}}}},false);worker.addEventListener("error",function(n){hobatext("Worker error: "+n.filename+":"+n.lineno+","+n.message)},false);workerok=true}}if(!workerok){hobatext("No background worker (sorry)");worker=null}var c=hoba_getpriv();var m=get_origin();var j=get_tbsorigin();var a=0;if(!workerok&&(c==null||c==undefined)){c=hoba_get_key(m,a)}if(workerok&&c==null){var k={cmd:"gen",alg:a,origin:m};worker.postMessage(k)}if(!workerok){hobatext("No background worker (sorry)")}if(workerok&&c!=null&&bgsigning){privstruct=hoba_get_key(m,a);if(privstruct){hobatext("worker will background sign");var k={cmd:"bgsign",alg:a,origin:m,tbsorigin:j,n:privstruct.n,e:privstruct.e,d:privstruct.d,kid:urlb64(privstruct.kid)};worker.postMessage(k)}else{hobatext("no background signing - waiting for key generation");hobatext("a reload after key gen done will fix")}}}catch(g){b=g.message}if(!d){hobatext("Checking browser is HOBA compatible...sorry doesn't seem to work."+b)}else{hobatext("Checking browser is HOBA compatible...seems fine, great!")}hoba_show_state()}function hoba_unreg(){hobatext("I'm gonna (try) delete your key!");var d=false;var a="";var b=0;var k;try{if(localStorage){var c=hoba_getpriv();if(c!=null){k=JSON.parse(c);if(k.state=="regok"){var j=hoba_make_auth_header();unregreq=new XMLHttpRequest();var h="/.well-known/hoba/unregister";unregreq.onreadystatechange=unregcallback;unregreq.open("POST",h,true);unregreq.setRequestHeader("Authorization","HOBA "+j);unregreq.send(null)}hoba_delpriv();d=true;var g={cmd:"gen",alg:b,origin:k.origin};worker.postMessage(g)}}}catch(f){a=f.message}if(!d){hobatext("Sorry - deleting failed: "+a)}else{hobatext("Deleted Key: "+k.kid)}}function hoba_showkid(){hobatext("I'm gonna (try) show yor your public key!");var d=false;var h="";var g=0;var f="priv:"+g;var a;try{if(localStorage){var c=hoba_getpriv();if(c!=null){d=true}a=JSON.parse(c)}}catch(b){h=b.message}if(!d){hobatext("Sorry - reading failed: "+h)}else{hobatext("Your Key for "+this.location+" has Key ID: "+a.kid+" and was created at: "+a.time+" and is in state: "+a.state)}}function ReadCookie(d){var b=" "+document.cookie;var c=b.indexOf(" "+d+"=");if(c==-1){c=b.indexOf(";"+d+"=")}if(c==-1||d==""){return""}var a=b.indexOf(";",c+1);if(a==-1){a=b.length}return unescape(b.substring(c+d.length+2,a))}function hoba_show_buttons(e,c){var a='<input id="login-button" type="button" value="Login" 		class="btn" onmouseover="hov(this,\'btn btnhov\')"  		onmouseout="hov(this,\'btn\')"  		onClick="hoba_login();"/>';var d='<input id="logout-button" type="button" value="Logout"  		class="btn" onmouseover="hov(this,\'btn btnhov\')"  		onmouseout="hov(this,\'btn\')"  		onClick="hoba_logout();" /> ';var f='<input id="reg-button" type="button" value="Register"  		class="btn" onmouseover="hov(this,\'btn btnhov\')"  		onmouseout="hov(this,\'btn\')"  		onClick="hoba_register();"/> ';var g="";var b=document.getElementById("buttons");if(!b){return}if(c=="regok"){if(e=="Loggedin"){b.innerHTML=g+d}else{b.innerHTML=g+a}}else{if(c=="new"){b.innerHTML=f}else{b.innerHTML="<p>Please reload</p>"}}}function hoba_show_state(){var e="dunno";var h=0;var g=hoba_getpriv();if(g!=null){var a=JSON.parse(g);e=a.state}var d=ReadCookie("HOBAState");hoba_show_buttons(d,e);if(ismsie){if(d=="Loggedin"){if(document.getElementById("login-state")){document.getElementById("login-state").innerHTML='<img src="/greentick-small.png" alt="You are logged in"/>'}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=true}if(document.getElementById("logout-button")){document.getElementById("logout-button").disabled=false}}else{if(document.getElementById("login-state")){document.getElementById("login-state").innerHTML='<img src="/redx-small.png" alt="You are logged out"/>'}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=false}if(document.getElementById("logout-button")){document.getElementById("logout-button").disabled=true}}if(e=="regok"){if(document.getElementById("reg-button")){document.getElementById("reg-button").disabled=true}if(document.getElementById("unreg-button")){document.getElementById("unreg-button").disabled=false}if(document.getElementById("show-button")){document.getElementById("show-button").disabled=false}}else{if(e=="reginwork"){if(document.getElementById("reg-button")){document.getElementById("reg-button").disabled=true}if(document.getElementById("unreg-button")){document.getElementById("unreg-button").disabled=false}if(document.getElementById("show-button")){document.getElementById("show-button").disabled=false}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=true}}else{if(e=="new"){if(document.getElementById("reg-button")){document.getElementById("reg-button").disabled=false}if(document.getElementById("unreg-button")){document.getElementById("unreg-button").disabled=true}if(document.getElementById("show-button")){document.getElementById("show-button").disabled=false}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=true}}else{if(document.getElementById("reg-button")){document.getElementById("reg-button").disabled=true}if(document.getElementById("unreg-button")){document.getElementById("unreg-button").disabled=true}if(document.getElementById("show-button")){document.getElementById("show-button").disabled=true}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=true}}}}}else{if(d=="Loggedin"){if(document.getElementById("login-state")){document.getElementById("login-state").innerHTML='<img src="/greentick-small.png" alt="You are logged in"/>'}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=true}if(document.getElementById("logout-button")){document.getElementById("logout-button").disabled=false}}else{if(document.getElementById("login-state")){document.getElementById("login-state").innerHTML='<img src="/redx-small.png" alt="You are logged out"/>'}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=false}if(document.getElementById("logout-button")){document.getElementById("logout-button").disabled=true}}if(e=="regok"){if(document.getElementById("reg-button")){document.getElementById("reg-button").disabled=true}if(document.getElementById("unreg-button")){document.getElementById("unreg-button").disabled=false}if(document.getElementById("show-button")){document.getElementById("show-button").disabled=false}}else{if(e=="reginwork"){if(document.getElementById("reg-button")){document.getElementById("reg-button").disabled=true}if(document.getElementById("unreg-button")){document.getElementById("unreg-button").disabled=false}if(document.getElementById("show-button")){document.getElementById("show-button").disabled=false}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=true}}else{if(e=="new"){if(document.getElementById("reg-button")){document.getElementById("reg-button").disabled=false}if(document.getElementById("unreg-button")){document.getElementById("unreg-button").disabled=true}if(document.getElementById("show-button")){document.getElementById("show-button").disabled=false}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=true}}else{if(document.getElementById("reg-button")){document.getElementById("reg-button").disabled=true}if(document.getElementById("unreg-button")){document.getElementById("unreg-button").disabled=true}if(document.getElementById("show-button")){document.getElementById("show-button").disabled=true}if(document.getElementById("login-button")){document.getElementById("login-button").disabled=true}}}}}var f=document.getElementById("regwarn");var c='<input id="acbod-reg-button" type="button" value="Register"  		class="btn" onmouseover="hov(this,\'btn btnhov\')"  		onmouseout="hov(this,\'btn\')"  		onClick="hoba_register();"/> ';var b='<input id="acbod-reg-button" type="button" value="Refresh"  		class="btn" onmouseover="hov(this,\'btn btnhov\')"  		onmouseout="hov(this,\'btn\')"  		onClick="history.go(0);"/> ';if(e!="regok"&&f){f.innerHTML="You're not registered - Please"+c+" and then "+b+" this page."}}function DeleteCookie(a,c,b){if(ReadCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}}function hoba_testprng(){var c="/.well-known/hoba/testprng";hobatext("those to "+c);hobatext("To do that I'll generate some random numbers and send");hobatext("Gonna test Pseudo-Random Number Generator on this device");var b=new SecureRandom();var e=new Array();e.length=8000;b.nextBytes(e);var a=new XMLHttpRequest();a.onload=function(){if(a.readyState==4&&a.status==200){hobatext(this.responseText)}else{if(a.readyState==4&&a.status>=400){hobatext("ERROR: "+this.responseText)}}};a.open("POST",c,true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");var d="&rndstr="+e;a.send(d)}function hoba_zap(){hobatext("Asked to zap");var a=confirm("Do you really want to delete your keys?");if(a){hoba_delpriv();localStorage.removeItem("hoba_test");DeleteCookie("HOBAState");document.getElementById("reg-button").disabled=false;document.getElementById("unreg-button").disabled=true;document.getElementById("show-button").disabled=true;document.getElementById("login-button").disabled=true;hobatext("Zapped it all. Back to zero.")}else{hobatext("No zapping - user changed her mind")}}function sign_n_submit(c,d,l){if(!c){return}if(!c.action){return}var h=new XMLHttpRequest();var k=hoba_make_auth_header();h.onload=function(){if(h.readyState==4&&h.status==200){if(document.getElementById(d)){document.getElementById(d).innerHTML=this.responseText}l()}else{if(h.readyState==4&&h.status>=400){if(document.getElementById(d)){document.getElementById(d).innerHTML=this.responseText}}}};if(c.method.toLowerCase()=="post"){h.open("post",c.action,true);h.setRequestHeader("Authorization","HOBA "+k);var b=new FormData(c);h.send(b)}else{var f,j,a,e="";for(var g=0;g<c.elements.length;g++){f=c.elements[g];if(!f.hasAttribute("name")){continue}j=f.nodeName.toUpperCase()==="INPUT"?f.getAttribute("type").toUpperCase():"TEXT";if(j==="FILE"){for(a=0;a<f.files.length;e+="&"+escape(f.name)+"="+escape(f.files[a++].name)){}}else{if((j!=="RADIO"&&j!=="CHECKBOX")||f.checked){e+="&"+escape(f.name)+"="+escape(f.value)}}}h.open("get",c.action.replace(/(?:\?.*)?$/,e.replace(/^&/,"?")),true);h.setRequestHeader("Authorization","HOBA "+k);h.send(null)}}function hoba_checkUA2(){var h=navigator.appName;if(h=="Microsoft Internet Explorer"){ismsie=true}clearhobatext();hobatext("Checking browser is HOBA compatible...");var d=false;var b="";try{var f=false;if(localStorage){localStorage.setItem("hoba_test","hoba_test");var l=localStorage.getItem("hoba_test");if(l!="hoba_test"){b="write/read error"}else{f=true;localStorage.removeItem("hoba_test")}}if(f){b="worker problem"}d=f;if(!ismsie&&window.Worker){worker=new Worker("/js/worker-min.js");if(worker){worker.addEventListener("message",function(o){var n=o.data;if(n.iskey){hoba_setpriv(n.key);hobatext("Key stored.")}else{if(n.issig){cachedsig=n.sig;cachedsigtime=new Date();hobatext("Got sig from worker")}else{if(n.msg){hobatext("Worker said: "+n.msg)}else{hobatext("garbled worker msg: "+o.data)}}}},false);worker.addEventListener("error",function(n){hobatext("Worker error: "+n.filename+":"+n.lineno+","+n.message)},false);workerok=true}}if(!workerok){hobatext("No background worker (sorry)");worker=null}var c=hoba_getpriv();var m=get_origin();var j=get_tbsorigin();var a=0;if(!workerok&&(c==null||c==undefined)){c=hoba_get_key(m,a)}if(workerok&&c==null){var k={cmd:"gen",alg:a,origin:m};worker.postMessage(k)}if(!workerok){hobatext("No background worker (sorry)")}if(workerok&&c!=null&&bgsigning){privstruct=hoba_get_key(m,a);if(privstruct){hobatext("worker will background sign");var k={cmd:"bgsign",alg:a,origin:m,tbsorigin:j,n:privstruct.n,e:privstruct.e,d:privstruct.d,kid:urlb64(privstruct.kid)};worker.postMessage(k)}else{hobatext("no background signing - waiting for key generation");hobatext("a reload after key gen done will fix")}}}catch(g){b=g.message}if(!d){hobatext("Checking browser is HOBA compatible...sorry doesn't seem to work."+b)}else{hobatext("Checking browser is HOBA compatible...seems fine, great!")}hoba_show_state()}var loginfailcount=0;function populate_ac(){hoba_checkUA();var e=ReadCookie("HOBAState");var d="dunno";var f=hoba_getpriv();if(f!=null){var b=JSON.parse(f);d=b.state}if(d!="regok"){hoba_show_state();return}if(d=="regok"&&loginfailcount<10&&e!="Loggedin"){loginfailcount++;hoba_login();setTimeout(populate_ac,100);return}var c=document.getElementById("resplace");if(c){c.innerHTML="populating..."}var a=document.getElementById("acidTable");if(a){a.rows[1].cells[0].innerHTML='<td> <input name ="txt[]" type="text" value="bogus@example.com"/> </td>'}var g=new XMLHttpRequest();g.onload=function(){if(g.readyState==4&&g.status==200&&g.responseText!=""){var h=JSON.parse(g.responseText);if(document.getElementById("hiddenfield")){var p='<input name="hf" type="hidden" value="'+h.hf+'"/>';document.getElementById("hiddenfield").innerHTML=p}if(h!=null){var s=document.getElementById("acidTable");var n=s.getElementsByTagName("tbody")[0];var q=n.rows.length;for(var m in h.ids){var w;if(m>=q){w=n.insertRow(m)}else{w=n.rows[m]}var k=h.ids[m][0];var u=h.ids[m][1];if(k=="email"){w.innerHTML='<tr>								<td> <input name ="txt[]" type="text" value="'+u+'"/> </td>								<td><select name="type[]">								<option selected value="email">email</option>								<option value="tel">phone</option>								<option value="xmpp">xmpp</option>								<option value="jabber">jabber</option>								<option value="sms">sms</option>								</select>								</td>								<td><input type="checkbox" name="chk[]"/></td>							</tr>'}if(k=="tel"){w.innerHTML='<tr>								<td> <input name ="txt[]" type="text" value="'+u+'"/> </td>								<td><select name="type[]">								<option value="email">email</option>								<option selected value="tel">phone</option>								<option value="xmpp">xmpp</option>								<option value="jabber">jabber</option>								<option value="sms">sms</option>								</select>								</td>								<td><input type="checkbox" name="chk[]"/></td>							</tr>'}if(k=="xmpp"){w.innerHTML='<tr>								<td> <input name ="txt[]" type="text" value="'+u+'"/> </td>								<td><select name="type[]">								<option value="email">email</option>								<option value="tel">phone</option>								<option selected value="xmpp">xmpp</option>								<option value="jabber">jabber</option>								<option value="sms">sms</option>								</select>								</td>								<td><input type="checkbox" name="chk[]"/></td>							</tr>'}if(k=="jabber"){w.innerHTML='<tr>								<td> <input name ="txt[]" type="text" value="'+u+'"/> </td>								<td><select name="type[]">								<option value="email">email</option>								<option value="tel">phone</option>								<option value="xmpp">xmpp</option>								<option selected value="jabber">jabber</option>								<option value="sms">sms</option>								</select>								</td>								<td><input type="checkbox" name="chk[]"/></td>							</tr>'}if(k=="sms"){w.innerHTML='<tr>								<td> <input name ="txt[]" type="text" value="'+u+'"/> </td>								<td><select name="type[]">								<option value="email">email</option>								<option value="tel">phone</option>								<option value="xmpp">xmpp</option>								<option value="jabber">jabber</option>								<option selected value="sms">sms</option>								</select>								</td>								<td><input type="checkbox" name="chk[]"/></td>							</tr>'}}s=document.getElementById("devTable");var n=s.getElementsByTagName("tbody")[0];q=n.rows.length;for(var m in h.kids){var w;if(m>=q){w=n.insertRow(m)}else{w=n.rows[m]}var r=h.kids[m][0];var o=h.kids[m][1];w.innerHTML='<tr>								<td> <input name ="devid[]" type="text" value="'+o+'"/> </td>								<td> <input size="5" readonly="yes" name ="keyid[]" type="text" value="'+r+'"/> </td>								<input type="hidden" name="deldev[]" value="0"/>								<td><input type="checkbox" name="deldev[]"/></td>								</td>								</tr>'}if(h.kids==undefined||h.kids.length==0){w=n.rows[0];var j=navigator.userAgent;var l=hoba_getmykid();w.innerHTML='<tr>								<td> <input name ="devid[]" type="text" value="'+j+'"/> </td>								<td> <input size="5" readonly="yes" name ="keyid[]" type="text" value="'+l+'"/> </td>								<input type="hidden" name="deldev[]" value="0"/>								<td><input type="checkbox" name="deldev[]"/></td>								</td>								</tr>'}}document.getElementById("resplace").innerHTML+="populated"}else{if(g.readyState==4&&g.status>=400&&g.status<499){document.getElementById("resplace").innerHTML="Oops";if(document.getElementById("regwarn")){document.getElementById("regwarn").innerHTML="Login expired ("+g.status+") - Try login afresh."}DeleteCookie("HOBAState")}}hoba_show_state()};g.open("GET","/.well-known/hoba/acinfo?justget=yes",true);g.send();hoba_show_state()}function refresh_ac(){table=document.getElementById("devTable");var b=table.getElementsByTagName("tbody")[0];rowCount=b.rows.length;for(var c=0;c<rowCount;c++){var d=b.rows[c];var a=d.cells[2].childNodes[0];if(null!=a&&true==a.checked){b.deleteRow(c);rowCount--;c--}}};